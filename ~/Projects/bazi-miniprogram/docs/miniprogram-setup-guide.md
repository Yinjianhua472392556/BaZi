# 微信小程序开发环境配置指南

## 项目导入步骤

### 1. 打开微信开发者工具
1. 启动微信开发者工具
2. 点击"新建项目"或"导入项目"

### 2. 项目配置
- **项目目录**: `~/Projects/bazi-miniprogram/miniprogram`
- **AppID**: 选择"测试号"（无AppID）或输入真实AppID
- **项目名称**: 八字运势小程序
- **开发模式**: 小程序

### 3. 项目结构说明
```
miniprogram/
├── app.json          # 全局配置文件
├── app.js            # 小程序逻辑文件
├── app.wxss          # 全局样式文件
├── project.config.json # 项目配置
├── sitemap.json      # 搜索优化配置
└── pages/            # 页面目录
    ├── index/        # 首页 - 八字测算
    │   ├── index.wxml
    │   ├── index.js
    │   └── index.wxss
    ├── result/       # 结果页 - 显示八字结果
    │   ├── result.wxml
    │   ├── result.js
    │   └── result.wxss
    ├── history/      # 历史记录页
    │   ├── history.wxml
    │   ├── history.js
    │   └── history.wxss
    └── profile/      # 个人中心页
        ├── profile.wxml
        ├── profile.js
        └── profile.wxss
```

## 开发环境配置

### 1. 网络配置
为了与后端API通信，需要在开发者工具中设置：

1. **关闭域名校验**：
   - 工具栏 → 设置 → 项目设置 → 本地设置
   - 勾选"不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书"

2. **确保后端服务运行**：
   ```bash
   cd ~/Projects/bazi-miniprogram
   source venv/bin/activate
   cd backend/app && python main.py
   # 服务运行在 http://localhost:8000
   ```

### 2. 调试配置
1. **打开调试模式**：
   - 开发者工具右上角 → 详情 → 本地设置
   - 勾选"开启调试模式"

2. **控制台日志**：
   - 点击"Console"标签查看日志输出
   - 网络请求可在"Network"标签中查看

### 3. 预览和真机调试
1. **模拟器预览**：
   - 直接在开发者工具中预览
   - 可以模拟不同设备尺寸

2. **真机调试**：
   - 点击"预览"生成二维码
   - 使用微信扫码在真机上测试

## 功能验证步骤

### 1. 基础功能测试
1. **启动小程序**：
   - 确保首页正常显示
   - 检查底部Tab导航是否正常

2. **API连接测试**：
   - 点击首页的"测试连接"按钮
   - 应该显示API连接成功的提示

### 2. 八字测算流程测试
1. **填写测算信息**：
   - 选择出生日期和时间
   - 选择性别
   - 可选填写姓名

2. **提交测算**：
   - 点击"开始测算"按钮
   - 观察网络请求是否正常
   - 检查是否跳转到结果页面

3. **查看结果**：
   - 验证八字排盘显示
   - 验证五行分析图表
   - 验证性格分析文本

### 3. 历史记录功能
1. **保存记录**：
   - 测算完成后自动保存
   - 或在结果页面手动保存

2. **查看历史**：
   - 切换到"历史记录"Tab
   - 验证历史记录列表显示
   - 点击记录可重新查看结果

## 常见问题解决

### 1. 网络请求失败
- **检查后端服务**：确保 http://localhost:8000 可访问
- **检查域名校验**：确保已关闭域名校验
- **查看控制台**：检查具体错误信息

### 2. 页面显示异常
- **清除缓存**：工具栏 → 清缓存 → 清除所有数据
- **重新编译**：Ctrl+Shift+R 强制刷新
- **检查代码**：查看控制台错误信息

### 3. 样式显示问题
- **检查rpx单位**：确保使用rpx而不是px
- **验证选择器**：检查CSS选择器是否正确
- **清除样式缓存**：重新编译项目

## 开发建议

### 1. 开发流程
1. **热重载**：保存文件后自动刷新
2. **实时调试**：使用console.log输出调试信息
3. **网络监控**：监控API请求和响应

### 2. 代码规范
- 使用ES6语法
- 保持代码缩进一致
- 添加必要的注释
- 遵循微信小程序开发规范

### 3. 性能优化
- 避免频繁的setData操作
- 合理使用组件生命周期
- 优化图片资源大小
- 减少不必要的网络请求

## 发布准备

### 1. 代码检查
- 移除调试代码和console.log
- 检查所有页面功能
- 验证用户体验流程

### 2. 配置更新
- 更新project.config.json中的AppID
- 配置合法域名（生产环境）
- 更新版本号

### 3. 上传代码
- 点击"上传"按钮
- 填写版本说明
- 提交审核

现在你可以在微信开发者工具中导入项目并开始开发了！
