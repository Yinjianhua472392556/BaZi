#!/usr/bin/env python3
"""
ç”Ÿè‚–é…å¯¹ç®—æ³•æ¨¡å— - å¤šç»´åº¦è¯„åˆ†ä½“ç³»
å®ç°ä¸“ä¸šçš„ç”Ÿè‚–é…å¯¹åˆ†æï¼ŒåŒ…å«5ä¸ªè¯„åˆ†ç»´åº¦å’Œå†å²åäººæ¡ˆä¾‹
"""

import random
from typing import Dict, List, Tuple, Any
from datetime import datetime

class ZodiacMatcher:
    """ç”Ÿè‚–é…å¯¹ç®—æ³•ç±»"""
    
    def __init__(self):
        """åˆå§‹åŒ–é…å¯¹ç®—æ³•"""
        self.zodiac_list = ['é¼ ', 'ç‰›', 'è™', 'å…”', 'é¾™', 'è›‡', 'é©¬', 'ç¾Š', 'çŒ´', 'é¸¡', 'ç‹—', 'çŒª']
        
        # åˆå§‹åŒ–å„ç§è¯„åˆ†çŸ©é˜µ
        self._init_emotion_matrix()
        self._init_personality_traits()
        self._init_career_compatibility()
        self._init_lifestyle_matrix()
        self._init_communication_matrix()
        self._init_famous_couples_database()
    
    def _init_emotion_matrix(self):
        """åˆå§‹åŒ–æ„Ÿæƒ…åŒ¹é…åº¦çŸ©é˜µ (30%)"""
        self.emotion_matrix = {
            'é¼ ': {'ç‰›': 95, 'é¾™': 90, 'çŒ´': 88, 'é©¬': 45, 'ç¾Š': 50, 'é¸¡': 60, 'çŒª': 75, 'è™': 70, 'å…”': 65, 'è›‡': 72, 'ç‹—': 68, 'é¼ ': 70},
            'ç‰›': {'é¼ ': 95, 'è›‡': 92, 'é¸¡': 90, 'ç¾Š': 40, 'é©¬': 48, 'ç‹—': 55, 'çŒª': 85, 'è™': 65, 'å…”': 70, 'é¾™': 75, 'çŒ´': 68, 'ç‰›': 72},
            'è™': {'çŒª': 94, 'é©¬': 89, 'ç‹—': 87, 'çŒ´': 42, 'è›‡': 45, 'é¾™': 58, 'ç‰›': 65, 'é¼ ': 70, 'å…”': 72, 'é¸¡': 68, 'ç¾Š': 75, 'è™': 68},
            'å…”': {'ç‹—': 93, 'ç¾Š': 88, 'çŒª': 86, 'é¸¡': 43, 'é¾™': 47, 'é¼ ': 65, 'ç‰›': 70, 'è™': 72, 'è›‡': 75, 'é©¬': 68, 'çŒ´': 70, 'å…”': 70},
            'é¾™': {'é¸¡': 96, 'é¼ ': 90, 'çŒ´': 85, 'ç‹—': 40, 'å…”': 47, 'ç¾Š': 55, 'çŒª': 70, 'ç‰›': 75, 'è™': 58, 'è›‡': 80, 'é©¬': 72, 'é¾™': 75},
            'è›‡': {'çŒ´': 94, 'ç‰›': 92, 'é¸¡': 88, 'çŒª': 41, 'è™': 45, 'é©¬': 60, 'é¾™': 80, 'é¼ ': 72, 'å…”': 75, 'ç‹—': 65, 'ç¾Š': 68, 'è›‡': 72},
            'é©¬': {'ç¾Š': 95, 'è™': 89, 'ç‹—': 86, 'é¼ ': 45, 'ç‰›': 48, 'å…”': 68, 'é¾™': 72, 'è›‡': 60, 'çŒ´': 70, 'é¸¡': 65, 'çŒª': 75, 'é©¬': 70},
            'ç¾Š': {'é©¬': 95, 'å…”': 88, 'çŒª': 85, 'ç‰›': 40, 'é¼ ': 50, 'ç‹—': 72, 'é¾™': 55, 'è™': 75, 'è›‡': 68, 'çŒ´': 70, 'é¸¡': 65, 'ç¾Š': 68},
            'çŒ´': {'è›‡': 94, 'é¼ ': 88, 'é¾™': 85, 'è™': 42, 'çŒª': 46, 'ç‰›': 68, 'é©¬': 70, 'å…”': 70, 'ç‹—': 75, 'é¸¡': 72, 'ç¾Š': 70, 'çŒ´': 72},
            'é¸¡': {'é¾™': 96, 'ç‰›': 90, 'è›‡': 88, 'å…”': 43, 'ç‹—': 44, 'ç¾Š': 65, 'é¼ ': 60, 'è™': 68, 'é©¬': 65, 'çŒ´': 72, 'çŒª': 70, 'é¸¡': 70},
            'ç‹—': {'å…”': 93, 'è™': 87, 'é©¬': 86, 'é¾™': 40, 'é¸¡': 44, 'ç‰›': 55, 'ç¾Š': 72, 'é¼ ': 68, 'è›‡': 65, 'çŒ´': 75, 'çŒª': 80, 'ç‹—': 72},
            'çŒª': {'è™': 94, 'å…”': 86, 'ç¾Š': 85, 'è›‡': 41, 'çŒ´': 46, 'é¸¡': 70, 'ç‰›': 85, 'é¼ ': 75, 'é¾™': 70, 'é©¬': 75, 'ç‹—': 80, 'çŒª': 75}
        }
    
    def _init_personality_traits(self):
        """åˆå§‹åŒ–æ€§æ ¼ç‰¹å¾æ•°æ®"""
        self.personality_traits = {
            'é¼ ': {'active': 9, 'smart': 9, 'social': 8, 'stable': 6},
            'ç‰›': {'active': 5, 'smart': 7, 'social': 6, 'stable': 9},
            'è™': {'active': 9, 'smart': 8, 'social': 8, 'stable': 5},
            'å…”': {'active': 6, 'smart': 8, 'social': 7, 'stable': 8},
            'é¾™': {'active': 8, 'smart': 9, 'social': 9, 'stable': 6},
            'è›‡': {'active': 6, 'smart': 9, 'social': 6, 'stable': 8},
            'é©¬': {'active': 9, 'smart': 7, 'social': 9, 'stable': 5},
            'ç¾Š': {'active': 6, 'smart': 7, 'social': 7, 'stable': 8},
            'çŒ´': {'active': 8, 'smart': 9, 'social': 9, 'stable': 6},
            'é¸¡': {'active': 7, 'smart': 8, 'social': 7, 'stable': 8},
            'ç‹—': {'active': 7, 'smart': 7, 'social': 8, 'stable': 9},
            'çŒª': {'active': 6, 'smart': 6, 'social': 8, 'stable': 8}
        }
    
    def _init_career_compatibility(self):
        """åˆå§‹åŒ–äº‹ä¸šåè°ƒåº¦æ•°æ®"""
        self.career_compatibility = {
            'é¼ ç‰›': 92, 'é¼ è™': 75, 'é¼ å…”': 68, 'é¼ é¾™': 88, 'é¼ è›‡': 72, 'é¼ é©¬': 55, 'é¼ ç¾Š': 62, 'é¼ çŒ´': 85, 'é¼ é¸¡': 70, 'é¼ ç‹—': 75, 'é¼ çŒª': 80,
            'ç‰›è™': 68, 'ç‰›å…”': 72, 'ç‰›é¾™': 78, 'ç‰›è›‡': 90, 'ç‰›é©¬': 58, 'ç‰›ç¾Š': 50, 'ç‰›çŒ´': 70, 'ç‰›é¸¡': 88, 'ç‰›ç‹—': 65, 'ç‰›çŒª': 82,
            'è™å…”': 70, 'è™é¾™': 65, 'è™è›‡': 55, 'è™é©¬': 86, 'è™ç¾Š': 72, 'è™çŒ´': 48, 'è™é¸¡': 62, 'è™ç‹—': 85, 'è™çŒª': 90,
            'å…”é¾™': 58, 'å…”è›‡': 72, 'å…”é©¬': 68, 'å…”ç¾Š': 85, 'å…”çŒ´': 65, 'å…”é¸¡': 52, 'å…”ç‹—': 88, 'å…”çŒª': 86,
            'é¾™è›‡': 78, 'é¾™é©¬': 70, 'é¾™ç¾Š': 62, 'é¾™çŒ´': 82, 'é¾™é¸¡': 95, 'é¾™ç‹—': 45, 'é¾™çŒª': 72,
            'è›‡é©¬': 65, 'è›‡ç¾Š': 68, 'è›‡çŒ´': 92, 'è›‡é¸¡': 86, 'è›‡ç‹—': 60, 'è›‡çŒª': 48,
            'é©¬ç¾Š': 90, 'é©¬çŒ´': 72, 'é©¬é¸¡': 68, 'é©¬ç‹—': 83, 'é©¬çŒª': 75,
            'ç¾ŠçŒ´': 68, 'ç¾Šé¸¡': 65, 'ç¾Šç‹—': 70, 'ç¾ŠçŒª': 84,
            'çŒ´é¸¡': 75, 'çŒ´ç‹—': 72, 'çŒ´çŒª': 58,
            'é¸¡ç‹—': 52, 'é¸¡çŒª': 68,
            'ç‹—çŒª': 82
        }
    
    def _init_lifestyle_matrix(self):
        """åˆå§‹åŒ–ç”Ÿæ´»ä¹ æƒ¯åŒ¹é…åº¦çŸ©é˜µ"""
        self.lifestyle_matrix = {
            'é¼ ': {'ç‰›': 85, 'é¾™': 88, 'çŒ´': 92, 'é©¬': 58, 'ç¾Š': 65, 'é¸¡': 72, 'çŒª': 78, 'è™': 70, 'å…”': 68, 'è›‡': 75, 'ç‹—': 72, 'é¼ ': 75},
            'ç‰›': {'é¼ ': 85, 'è›‡': 90, 'é¸¡': 88, 'ç¾Š': 52, 'é©¬': 55, 'ç‹—': 68, 'çŒª': 82, 'è™': 65, 'å…”': 75, 'é¾™': 78, 'çŒ´': 70, 'ç‰›': 80},
            'è™': {'çŒª': 88, 'é©¬': 85, 'ç‹—': 82, 'çŒ´': 55, 'è›‡': 58, 'é¾™': 65, 'ç‰›': 65, 'é¼ ': 70, 'å…”': 75, 'é¸¡': 68, 'ç¾Š': 78, 'è™': 70},
            'å…”': {'ç‹—': 86, 'ç¾Š': 84, 'çŒª': 81, 'é¸¡': 54, 'é¾™': 58, 'é¼ ': 68, 'ç‰›': 75, 'è™': 75, 'è›‡': 78, 'é©¬': 70, 'çŒ´': 72, 'å…”': 75},
            'é¾™': {'é¸¡': 90, 'é¼ ': 88, 'çŒ´': 80, 'ç‹—': 48, 'å…”': 58, 'ç¾Š': 65, 'çŒª': 72, 'ç‰›': 78, 'è™': 65, 'è›‡': 82, 'é©¬': 75, 'é¾™': 78},
            'è›‡': {'çŒ´': 87, 'ç‰›': 90, 'é¸¡': 85, 'çŒª': 52, 'è™': 58, 'é©¬': 68, 'é¾™': 82, 'é¼ ': 75, 'å…”': 78, 'ç‹—': 68, 'ç¾Š': 70, 'è›‡': 78},
            'é©¬': {'ç¾Š': 89, 'è™': 85, 'ç‹—': 80, 'é¼ ': 58, 'ç‰›': 55, 'å…”': 70, 'é¾™': 75, 'è›‡': 68, 'çŒ´': 72, 'é¸¡': 68, 'çŒª': 78, 'é©¬': 75},
            'ç¾Š': {'é©¬': 89, 'å…”': 84, 'çŒª': 81, 'ç‰›': 52, 'é¼ ': 65, 'ç‹—': 75, 'é¾™': 65, 'è™': 78, 'è›‡': 70, 'çŒ´': 72, 'é¸¡': 68, 'ç¾Š': 75},
            'çŒ´': {'è›‡': 87, 'é¼ ': 92, 'é¾™': 80, 'è™': 55, 'çŒª': 58, 'ç‰›': 70, 'é©¬': 72, 'å…”': 72, 'ç‹—': 78, 'é¸¡': 75, 'ç¾Š': 72, 'çŒ´': 78},
            'é¸¡': {'é¾™': 90, 'ç‰›': 88, 'è›‡': 85, 'å…”': 54, 'ç‹—': 56, 'ç¾Š': 68, 'é¼ ': 72, 'è™': 68, 'é©¬': 68, 'çŒ´': 75, 'çŒª': 72, 'é¸¡': 75},
            'ç‹—': {'å…”': 86, 'è™': 82, 'é©¬': 80, 'é¾™': 48, 'é¸¡': 56, 'ç‰›': 68, 'ç¾Š': 75, 'é¼ ': 72, 'è›‡': 68, 'çŒ´': 78, 'çŒª': 85, 'ç‹—': 78},
            'çŒª': {'è™': 88, 'å…”': 81, 'ç¾Š': 81, 'è›‡': 52, 'çŒ´': 58, 'é¸¡': 72, 'ç‰›': 82, 'é¼ ': 78, 'é¾™': 72, 'é©¬': 78, 'ç‹—': 85, 'çŒª': 80}
        }
    
    def _init_communication_matrix(self):
        """åˆå§‹åŒ–æ²Ÿé€šé»˜å¥‘åº¦çŸ©é˜µ"""
        self.communication_matrix = {
            'é¼ ç‰›': 88, 'é¼ è™': 72, 'é¼ å…”': 68, 'é¼ é¾™': 85, 'é¼ è›‡': 75, 'é¼ é©¬': 58, 'é¼ ç¾Š': 65, 'é¼ çŒ´': 90, 'é¼ é¸¡': 70, 'é¼ ç‹—': 75, 'é¼ çŒª': 78,
            'ç‰›è™': 65, 'ç‰›å…”': 75, 'ç‰›é¾™': 78, 'ç‰›è›‡': 88, 'ç‰›é©¬': 55, 'ç‰›ç¾Š': 52, 'ç‰›çŒ´': 72, 'ç‰›é¸¡': 85, 'ç‰›ç‹—': 68, 'ç‰›çŒª': 80,
            'è™å…”': 72, 'è™é¾™': 68, 'è™è›‡': 58, 'è™é©¬': 83, 'è™ç¾Š': 75, 'è™çŒ´': 52, 'è™é¸¡': 65, 'è™ç‹—': 82, 'è™çŒª': 86,
            'å…”é¾™': 62, 'å…”è›‡': 75, 'å…”é©¬': 70, 'å…”ç¾Š': 82, 'å…”çŒ´': 68, 'å…”é¸¡': 55, 'å…”ç‹—': 85, 'å…”çŒª': 83,
            'é¾™è›‡': 80, 'é¾™é©¬': 72, 'é¾™ç¾Š': 65, 'é¾™çŒ´': 78, 'é¾™é¸¡': 92, 'é¾™ç‹—': 48, 'é¾™çŒª': 70,
            'è›‡é©¬': 68, 'è›‡ç¾Š': 70, 'è›‡çŒ´': 88, 'è›‡é¸¡': 83, 'è›‡ç‹—': 62, 'è›‡çŒª': 52,
            'é©¬ç¾Š': 86, 'é©¬çŒ´': 70, 'é©¬é¸¡': 65, 'é©¬ç‹—': 80, 'é©¬çŒª': 72,
            'ç¾ŠçŒ´': 70, 'ç¾Šé¸¡': 68, 'ç¾Šç‹—': 72, 'ç¾ŠçŒª': 81,
            'çŒ´é¸¡': 78, 'çŒ´ç‹—': 75, 'çŒ´çŒª': 62,
            'é¸¡ç‹—': 55, 'é¸¡çŒª': 70,
            'ç‹—çŒª': 79
        }
    
    def _init_famous_couples_database(self):
        """åˆå§‹åŒ–å†å²åäººæ¡ˆä¾‹æ•°æ®åº“ - å®Œæ•´ç‰ˆ"""
        self.famous_couples = {
            # é¼ å¹´é…å¯¹
            'é¼ ç‰›': [
                {'name': 'é’±å­¦æ£® & è’‹è‹±', 'story': 'ç§‘å­¦å®¶ä¸éŸ³ä¹å®¶çš„å®Œç¾ç»“åˆï¼Œç†æ€§ä¸æ„Ÿæ€§çš„å¹³è¡¡', 'traits': 'äº’è¡¥åˆä½œï¼Œæˆå°±å½¼æ­¤'},
                {'name': 'æ¢æ€æˆ & æ—å¾½å› ', 'story': 'å»ºç­‘å­¦å®¶å¤«å¦‡ï¼Œå­¦æœ¯ä¸ç”Ÿæ´»çš„åŒé‡ä¼´ä¾£', 'traits': 'å¿—åŒé“åˆï¼Œç›¸äº’æˆå°±'}
            ],
            'é¼ è™': [
                {'name': 'é²è¿… & è®¸å¹¿å¹³', 'story': 'æ–‡å­¦å·¨åŒ ä¸å¿ å®ä¼´ä¾£ï¼Œå¸ˆç”Ÿæƒ…ç¼˜æˆå°±ä¸€æ®µä½³è¯', 'traits': 'å¿—åŒé“åˆï¼Œæ–‡å­¦æƒ…ç¼˜'}
            ],
            'é¼ å…”': [
                {'name': 'èƒ¡é€‚ & æ±Ÿå†¬ç§€', 'story': 'å­¦è€…ä¸è´¤å¦»çš„ä¼ ç»Ÿä¸ç°ä»£ç»“åˆ', 'traits': 'ç›¸äº’åŒ…å®¹ï¼Œä¼ ç»Ÿç¾å¾·'}
            ],
            'é¼ é¾™': [
                {'name': 'èŒ…ç›¾ & å­”å¾·æ²š', 'story': 'æ–‡å­¦å®¶çš„ç¾æ»¡å§»ç¼˜ï¼Œæ‰å¥³é…æ‰å­', 'traits': 'æ–‡å­¦ç†æƒ³ï¼Œç”Ÿæ´»å’Œè°'}
            ],
            'é¼ è›‡': [
                {'name': 'è´¹å­é€š & ç‹åŒæƒ ', 'story': 'ç¤¾ä¼šå­¦å®¶çš„å­¦è€…çˆ±æƒ…ï¼Œå…±åŒçš„å­¦æœ¯è¿½æ±‚', 'traits': 'å­¦æœ¯ä¼´ä¾£ï¼Œç†æƒ³ç›¸åŒ'}
            ],
            'é¼ é©¬': [
                {'name': 'å†°å¿ƒ & å´æ–‡è—»', 'story': 'æ–‡å­¦å®¶ä¸ç¤¾ä¼šå­¦å®¶çš„è·¨ç•Œçˆ±æƒ…', 'traits': 'æ‰åäº’è¡¥ï¼Œæ¸©é¦¨å®¶åº­'}
            ],
            'é¼ ç¾Š': [
                {'name': 'å¶åœ£é™¶ & èƒ¡å¢¨æ—', 'story': 'æ•™è‚²å®¶çš„æ¸©é¦¨å®¶åº­ï¼Œæ–‡å­¦ä¸ç”Ÿæ´»çš„å®Œç¾ç»“åˆ', 'traits': 'æ¸©é¦¨æ¬æ·¡ï¼Œç›¸æ•¬å¦‚å®¾'}
            ],
            'é¼ çŒ´': [
                {'name': 'é½ç™½çŸ³ & èƒ¡å®ç ', 'story': 'å¤§ç”»å®¶ä¸å¹´è½»å¦»å­çš„å¿˜å¹´æ‹ï¼Œè‰ºæœ¯ä¸é’æ˜¥çš„ç¢°æ’', 'traits': 'è‰ºæœ¯æµªæ¼«ï¼Œå¿˜å¹´ä¹‹æ‹'}
            ],
            'é¼ é¸¡': [
                {'name': 'ç¿¦ä¼¯èµ & æˆ´æ·‘å©‰', 'story': 'å†å²å­¦å®¶å¤«å¦‡ï¼Œå…±åŒçš„å²å­¦ç†æƒ³', 'traits': 'å­¦æœ¯æƒ…æ·±ï¼Œå¿—åŒé“åˆ'}
            ],
            'é¼ ç‹—': [
                {'name': 'æ²ˆä»æ–‡ & å¼ å…†å’Œ', 'story': 'æ–‡å­¦å¤§å¸ˆçš„æµªæ¼«è¿½æ±‚ï¼Œä¸‰å§å¼ å…†å’Œçš„çˆ±æƒ…ä¼ å¥‡', 'traits': 'æµªæ¼«æ–‡å­¦ï¼Œç»†æ°´é•¿æµ'}
            ],
            'é¼ çŒª': [
                {'name': 'æ›¹ç¦º & æ–¹ç‘', 'story': 'æˆå‰§å¤§å¸ˆçš„ç¬¬äºŒæ¬¡å©šå§»ï¼Œè‰ºæœ¯ä¸ç”Ÿæ´»çš„é‡æ–°å¼€å§‹', 'traits': 'æˆå‰§äººç”Ÿï¼Œé‡æ–°å¼€å§‹'}
            ],
            
            # ç‰›å¹´é…å¯¹
            'ç‰›è™': [
                {'name': 'ä¾¯å¾·æ¦œ & å¼ æ¸…å¦‚', 'story': 'åŒ–å­¦å®¶ä¸è´¤å†…åŠ©ï¼Œç§‘å­¦ä¸å®¶åº­çš„å¹³è¡¡', 'traits': 'ç§‘å­¦ä¸¥è°¨ï¼Œå®¶åº­å’Œç¦'}
            ],
            'ç‰›å…”': [
                {'name': 'ç«ºå¯æ¡¢ & é™ˆæ±²', 'story': 'åœ°ç†å­¦å®¶ä¸åŒ»ç”Ÿå¤«å¦‡ï¼Œç§‘å­¦ä¸åŒ»å­¦çš„ç»“åˆ', 'traits': 'ç§‘å­¦ç†æ€§ï¼Œç›¸äº’ç†è§£'}
            ],
            'ç‰›é¾™': [
                {'name': 'é©¬å¯…åˆ & å¼ æ¡‚å›', 'story': 'ç»æµå­¦å®¶çš„å­¦è€…å®¶åº­ï¼Œå­¦æœ¯ä¸å“æ ¼çš„å…¸èŒƒ', 'traits': 'å­¦è€…é£èŒƒï¼Œå“æ ¼é«˜å°š'}
            ],
            'ç‰›è›‡': [
                {'name': 'ä¸°å­æº & å¢ç’‹', 'story': 'ç”»å®¶çš„æ¸©é¦¨å®¶åº­ï¼Œè‰ºæœ¯ä¸ç”Ÿæ´»çš„å®Œç¾èåˆ', 'traits': 'è‰ºæœ¯ä¸ç”Ÿæ´»ï¼Œæ¸©é¦¨æ¬æ·¡'}
            ],
            'ç‰›é©¬': [
                {'name': 'æå››å…‰ & è®¸æ·‘å½¬', 'story': 'åœ°è´¨å­¦å®¶ä¸éŸ³ä¹å®¶ï¼Œç§‘å­¦ä¸è‰ºæœ¯çš„å®Œç¾ç»“åˆ', 'traits': 'ç§‘å­¦è‰ºæœ¯ï¼Œäº’è¡¥å’Œè°'}
            ],
            'ç‰›ç¾Š': [
                {'name': 'æ¢å¯è¶… & æè•™ä»™', 'story': 'æ€æƒ³å®¶ä¸è´¤å¦»çš„ä¼ ç»Ÿå®¶åº­ï¼Œå­¦è€…ä¸å®¶åº­çš„å¹³è¡¡', 'traits': 'ä¼ ç»Ÿç¾å¾·ï¼Œç›¸æ•¬å¦‚å®¾'}
            ],
            'ç‰›çŒ´': [
                {'name': 'ä¸¥å¤ & ç‹æ°', 'story': 'ç¿»è¯‘å®¶çš„ä¼ ç»Ÿå®¶åº­ï¼Œè¥¿å­¦ä¸ä¸­å­¦çš„èåˆ', 'traits': 'å­¦è´¯ä¸­è¥¿ï¼Œå®¶åº­å’Œç¦'}
            ],
            'ç‰›é¸¡': [
                {'name': 'é¡¾ç»´é’§ & é»„è•™å…°', 'story': 'å¤–äº¤å®¶ä¸ååª›çš„ä¸Šæµ·æ»©ä¼ å¥‡', 'traits': 'å¤–äº¤é£é‡‡ï¼Œç¤¾äº¤åæµ'}
            ],
            'ç‰›ç‹—': [
                {'name': 'é™ˆå˜‰åºš & å¼ å®æœ', 'story': 'å®ä¸šå®¶ä¸è´¤å¦»çš„åˆ›ä¸šä¼ å¥‡', 'traits': 'å®ä¸šæŠ¥å›½ï¼Œè´¤å†…åŠ©åŠ›'}
            ],
            'ç‰›çŒª': [
                {'name': 'åç½—åºš & å´ç­±å…ƒ', 'story': 'æ•°å­¦å®¶ä¸è´¤å†…åŠ©çš„å…¸èŒƒï¼Œä¸“æ³¨å­¦æœ¯ä¸æŒå®¶', 'traits': 'å‹¤å‹‰è¸å®ï¼Œç›¸äº’æ”¯æ’‘'},
                {'name': 'å­£ç¾¡æ— & å½­å¾·å', 'story': 'å›½å­¦å¤§å¸ˆçš„æ¸©é¦¨å®¶åº­ï¼Œå­¦è€…çš„æœ´å®ç”Ÿæ´»', 'traits': 'å­¦è€…é£èŒƒï¼Œå®¶åº­å’Œç¦'}
            ],
            
            # è™å¹´é…å¯¹
            'è™å…”': [
                {'name': 'é™ˆç‹¬ç§€ & é«˜å¤§ä¼—', 'story': 'é©å‘½å®¶ä¸è´¤å¦»çš„é©å‘½å²æœˆ', 'traits': 'é©å‘½ç†æƒ³ï¼Œæ‚£éš¾ä¸å…±'}
            ],
            'è™é¾™': [
                {'name': 'è”¡å…ƒåŸ¹ & é»„ä»²ç‰', 'story': 'æ•™è‚²å®¶ä¸å¤«äººçš„å­¦è€…å®¶åº­', 'traits': 'æ•™è‚²ç†æƒ³ï¼Œå­¦è€…é£èŒƒ'}
            ],
            'è™è›‡': [
                {'name': 'å¾æ‚²é¸¿ & å»–é™æ–‡', 'story': 'ç”»å®¶ä¸å­¦ç”Ÿçš„å¸ˆç”Ÿæ‹ï¼Œè‰ºæœ¯ä¸é’æ˜¥çš„ç¢°æ’', 'traits': 'è‰ºæœ¯æµªæ¼«ï¼Œå¸ˆç”Ÿæƒ…æ·±'}
            ],
            'è™é©¬': [
                {'name': 'è‚è€³ & è¢æ˜¥æ™–', 'story': 'éŸ³ä¹å®¶çš„çŸ­æš‚è€Œç¾å¥½çš„çˆ±æƒ…', 'traits': 'éŸ³ä¹æµªæ¼«ï¼Œé’æ˜¥å¹´å'}
            ],
            'è™ç¾Š': [
                {'name': 'å‚…é›· & æœ±æ¢…é¦¥', 'story': 'ç¿»è¯‘å®¶å¤«å¦‡çš„æ–‡å­¦å®¶åº­ï¼Œè‰ºæœ¯ä¸ç”Ÿæ´»çš„å®Œç¾ç»“åˆ', 'traits': 'æ–‡å­¦è‰ºæœ¯ï¼Œç›¸æ¿¡ä»¥æ²«'}
            ],
            'è™çŒ´': [
                {'name': 'é—»ä¸€å¤š & é«˜å­è´', 'story': 'è¯—äººå­¦è€…çš„ä¼ ç»Ÿä¸ç°ä»£ç»“åˆ', 'traits': 'è¯—äººæ°”è´¨ï¼Œä¼ ç»Ÿç¾å¾·'}
            ],
            'è™é¸¡': [
                {'name': 'åˆ˜ç™½ç¾½ & æ±ªç¿ äº‘', 'story': 'ä½œå®¶ä¸ç¼–è¾‘çš„æ–‡å­¦ä¼´ä¾£', 'traits': 'æ–‡å­¦æƒ…ç¼˜ï¼Œç¼–è¾‘ä¼´ä¾£'}
            ],
            'è™ç‹—': [
                {'name': 'ç”°æ±‰ & å®‰å¨¥', 'story': 'æˆå‰§å®¶ä¸è¯ä½œå®¶çš„è‰ºæœ¯ä¼´ä¾£', 'traits': 'æˆå‰§äººç”Ÿï¼Œè‰ºæœ¯ä¼´ä¾£'}
            ],
            'è™çŒª': [
                {'name': 'å‘¨æ©æ¥ & é‚“é¢–è¶…', 'story': 'é©å‘½ä¼´ä¾£ï¼Œé£é›¨åŒèˆŸæ•°åè½½', 'traits': 'å¿ è¯šåšå®šï¼Œæ‚£éš¾ä¸å…±'},
                {'name': 'æœ±å¾· & åº·å…‹æ¸…', 'story': 'å°†å†›ä¸æˆ˜å£«çš„é©å‘½æƒ…ç¼˜', 'traits': 'å¿—å‘ä¸€è‡´ï¼Œå…±åŒå¥‹æ–—'}
            ],
            
            # å…”å¹´é…å¯¹
            'å…”é¾™': [
                {'name': 'å·´é‡‘ & è§çŠ', 'story': 'æ–‡å­¦å¤§å¸ˆçš„æ¸©æš–å®¶åº­ï¼Œè§çŠçš„é»˜é»˜æ”¯æŒæˆå°±äº†å·´é‡‘', 'traits': 'æ–‡å­¦ç†æƒ³ï¼Œæ¸©é¦¨ç”Ÿæ´»'}
            ],
            'å…”è›‡': [
                {'name': 'è€èˆ & èƒ¡çµœé’', 'story': 'ä½œå®¶ä¸ç”»å®¶çš„è‰ºæœ¯äººç”Ÿï¼Œæ–‡å­¦ä¸ç»˜ç”»çš„å®Œç¾ç»“åˆ', 'traits': 'è‰ºæœ¯å…±é¸£ï¼Œç›¸å¾—ç›Šå½°'}
            ],
            'å…”é©¬': [
                {'name': 'æœ±è‡ªæ¸… & é™ˆç«¹éš', 'story': 'æ•£æ–‡å®¶çš„ç¬¬äºŒæ®µå©šå§»ï¼Œæ–‡å­¦ä¸å®¶åº­çš„é‡æ–°å¼€å§‹', 'traits': 'æ–‡å­¦æ¸©é¦¨ï¼Œé‡æ–°å¼€å§‹'}
            ],
            'å…”ç¾Š': [
                {'name': 'éƒè¾¾å¤« & ç‹æ˜ éœ', 'story': 'ä½œå®¶ä¸ç¾å¥³çš„æµªæ¼«çˆ±æƒ…ï¼Œæ­å·è¥¿æ¹–è¾¹çš„æ–‡å­¦ä¼ å¥‡', 'traits': 'æ–‡å­¦æµªæ¼«ï¼Œè¥¿æ¹–æƒ…ç¼˜'}
            ],
            'å…”çŒ´': [
                {'name': 'å¤è¡ & é™ˆæ³¢å„¿', 'story': 'å‰§ä½œå®¶ä¸æ¼”å‘˜çš„æˆå‰§äººç”Ÿ', 'traits': 'æˆå‰§æƒ…ç¼˜ï¼Œè‰ºæœ¯ä¼´ä¾£'}
            ],
            'å…”é¸¡': [
                {'name': 'è´ºæ•¬ä¹‹ & æŸ¯å²©', 'story': 'è¯—äººå¤«å¦‡çš„æ–‡å­¦ä¼ å¥‡ï¼Œå…±åŒçš„è¯—æ­Œç†æƒ³', 'traits': 'è¯—æ­Œæƒ…ç¼˜ï¼Œæ–‡å­¦ä¼´ä¾£'}
            ],
            'å…”ç‹—': [
                {'name': 'é’±é’Ÿä¹¦ & æ¨ç»›', 'story': 'æ–‡å­¦ä¼‰ä¿ªï¼Œæ‰åæ¨ªæº¢çš„å­¦è€…å¤«å¦‡', 'traits': 'æ‰åç›¸é…ï¼Œç´ç‘Ÿå’Œé¸£'}
            ],
            'å…”çŒª': [
                {'name': 'è§çº¢ & è§å†›', 'story': 'ä¸œåŒ—ä½œå®¶å¤«å¦‡çš„æ–‡å­¦ä¼ å¥‡ï¼Œæ‰åæ¨ªæº¢çš„æ–‡å­¦ä¼´ä¾£', 'traits': 'æ–‡å­¦æ‰åï¼Œä¸œåŒ—é£æƒ…'}
            ],
            
            # é¾™å¹´é…å¯¹
            'é¾™è›‡': [
                {'name': 'éƒ­æ²«è‹¥ & äºç«‹ç¾¤', 'story': 'æ–‡å­¦å®¶ä¸æˆå‰§å®¶çš„æ–‡åŒ–å§»ç¼˜', 'traits': 'æ–‡åŒ–å…±é¸£ï¼Œåˆ›ä½œä¼´ä¾£'}
            ],
            'é¾™é©¬': [
                {'name': 'çŸ›ç›¾ & å­”å¾·æ²š', 'story': 'ç°å®ä¸»ä¹‰ä½œå®¶çš„æ–‡å­¦å®¶åº­', 'traits': 'ç°å®ä¸»ä¹‰ï¼Œæ–‡å­¦ç†æƒ³'}
            ],
            'é¾™ç¾Š': [
                {'name': 'å´æ™— & è¢éœ‡', 'story': 'å†å²å­¦å®¶çš„å­¦è€…å®¶åº­', 'traits': 'å²å­¦ç ”ç©¶ï¼Œå­¦è€…é£èŒƒ'}
            ],
            'é¾™çŒ´': [
                {'name': 'å¶æŒº & æç§€æ–‡', 'story': 'å†›äº‹å®¶ä¸è´¤å¦»çš„é©å‘½å²æœˆ', 'traits': 'é©å‘½å†›äººï¼Œè´¤å†…åŠ©åŠ›'}
            ],
            'é¾™é¸¡': [
                {'name': 'å·´é‡‘ & è§çŠ', 'story': 'æ–‡å­¦å¤§å¸ˆçš„æ¸©æš–å®¶åº­', 'traits': 'æ–‡å­¦ç†æƒ³ï¼Œæ¸©é¦¨ç”Ÿæ´»'}
            ],
            'é¾™ç‹—': [
                {'name': 'é™¶è¡ŒçŸ¥ & å´æ ‘ç´', 'story': 'æ•™è‚²å®¶çš„æ•™è‚²ç†æƒ³å®¶åº­', 'traits': 'æ•™è‚²ç†æƒ³ï¼Œå¹³æ°‘æƒ…æ€€'}
            ],
            'é¾™çŒª': [
                {'name': 'æå®—ä» & éƒ­å¾·æ´', 'story': 'å°†å†›ä¸å¤«äººçš„ä¼ å¥‡äººç”Ÿ', 'traits': 'å°†å†›é£èŒƒï¼Œå¤«äººè´¤å¾·'}
            ],
            
            # è›‡å¹´é…å¯¹
            'è›‡é©¬': [
                {'name': 'é’±ä¸‰å¼º & ä½•æ³½æ…§', 'story': 'ç‰©ç†å­¦å®¶å¤«å¦‡ï¼Œç§‘å­¦ä¸çˆ±æƒ…çš„å®Œç¾ç»“åˆ', 'traits': 'ç§‘å­¦ä¼´ä¾£ï¼Œæ ¸ç‰©ç†'}
            ],
            'è›‡ç¾Š': [
                {'name': 'ä¸ç² & èƒ¡ä¹Ÿé¢‘', 'story': 'å¥³ä½œå®¶çš„é©å‘½çˆ±æƒ…ï¼Œæ–‡å­¦ä¸é©å‘½çš„ç»“åˆ', 'traits': 'é©å‘½æ–‡å­¦ï¼Œå¥³æ€§å…ˆé”‹'}
            ],
            'è›‡çŒ´': [
                {'name': 'å¼ çˆ±ç² & èƒ¡å…°æˆ', 'story': 'æ‰å¥³ä¸æ‰å­çš„ä¼ å¥‡çˆ±æƒ…', 'traits': 'æ‰åæ¨ªæº¢ï¼Œæƒºæƒºç›¸æƒœ'}
            ],
            'è›‡é¸¡': [
                {'name': 'è‰¾é’ & é«˜ç‘›', 'story': 'è¯—äººçš„è¯—æ„äººç”Ÿ', 'traits': 'è¯—æ­Œç†æƒ³ï¼Œè‰ºæœ¯äººç”Ÿ'}
            ],
            'è›‡ç‹—': [
                {'name': 'å†¯å‹å…° & ä»»è½½å¤', 'story': 'å“²å­¦å®¶çš„ç†æ€§å®¶åº­', 'traits': 'å“²å­¦ç†æ€§ï¼Œå­¦è€…å®¶åº­'}
            ],
            'è›‡çŒª': [
                {'name': 'èµµä¸¹ & é»„å®—è‹±', 'story': 'æ¼”å‘˜å¤«å¦‡çš„è‰ºæœ¯äººç”Ÿ', 'traits': 'è¡¨æ¼”è‰ºæœ¯ï¼Œé“¶å¹•æƒ…ç¼˜'}
            ],
            
            # é©¬å¹´é…å¯¹
            'é©¬ç¾Š': [
                {'name': 'å¾å¿—æ‘© & é™†å°æ›¼', 'story': 'è¯—äººä¸æ‰å¥³çš„æµªæ¼«ä¼ è¯´', 'traits': 'æµªæ¼«æƒ…æ€€ï¼Œè‰ºæœ¯è¿½æ±‚'}
            ],
            'é©¬çŒ´': [
                {'name': 'å¯åŠŸ & ç« å®ç›', 'story': 'ä¹¦æ³•å®¶çš„ä¼ ç»Ÿæ–‡åŒ–å®¶åº­', 'traits': 'ä¹¦æ³•è‰ºæœ¯ï¼Œä¼ ç»Ÿæ–‡åŒ–'}
            ],
            'é©¬é¸¡': [
                {'name': 'è§ä¹¾ & æ–‡æ´è‹¥', 'story': 'ä½œå®¶ä¸ç¿»è¯‘å®¶çš„æ–‡å­¦ä¼´ä¾£', 'traits': 'æ–‡å­¦ç¿»è¯‘ï¼Œå›½é™…è§†é‡'}
            ],
            'é©¬ç‹—': [
                {'name': 'ç¨‹ç šç§‹ & æœç´ ç‘›', 'story': 'äº¬å‰§å¤§å¸ˆçš„æ¢¨å›­ä¼ å¥‡', 'traits': 'äº¬å‰§è‰ºæœ¯ï¼Œæ¢¨å›­æƒ…ç¼˜'}
            ],
            'é©¬çŒª': [
                {'name': 'é»„æ°¸ç‰ & å¼ æ¢…æºª', 'story': 'ç”»å®¶çš„è‰ºæœ¯äººç”Ÿ', 'traits': 'ç»˜ç”»è‰ºæœ¯ï¼Œæ¹˜è¥¿é£æƒ…'}
            ],
            
            # ç¾Šå¹´é…å¯¹
            'ç¾ŠçŒ´': [
                {'name': 'è‡§å…‹å®¶ & éƒ‘ç¬ƒæª', 'story': 'è¯—äººçš„è¯—æ„ç”Ÿæ´»', 'traits': 'è¯—æ­Œäººç”Ÿï¼Œä¹¡åœŸæƒ…æ€€'}
            ],
            'ç¾Šé¸¡': [
                {'name': 'æ›¹èšä» & é‚“ç‚äº‘', 'story': 'ä½œå®¶çš„æ–‡å­¦å®¶åº­', 'traits': 'æ–‡å­¦åˆ›ä½œï¼Œæ¸¯å°æƒ…ç¼˜'}
            ],
            'ç¾Šç‹—': [
                {'name': 'æ¢…å…°èŠ³ & ç¦èŠèŠ³', 'story': 'äº¬å‰§å¤§å¸ˆçš„æ¢¨å›­ä½³è¯', 'traits': 'äº¬å‰§è‰ºæœ¯ï¼Œå¤§å¸ˆé£èŒƒ'}
            ],
            'ç¾ŠçŒª': [
                {'name': 'äºå³ä»» & é«˜ä»²æ—', 'story': 'ä¹¦æ³•å®¶çš„ä¼ ç»Ÿå®¶åº­', 'traits': 'ä¹¦æ³•è‰ºæœ¯ï¼Œä¼ ç»Ÿé£èŒƒ'}
            ],
            
            # çŒ´å¹´é…å¯¹
            'çŒ´é¸¡': [
                {'name': 'ä¾¯å®æ— & ç‹é›…å…°', 'story': 'ç›¸å£°å¤§å¸ˆçš„è‰ºæœ¯å®¶åº­', 'traits': 'ç›¸å£°è‰ºæœ¯ï¼Œå¹½é»˜äººç”Ÿ'}
            ],
            'çŒ´ç‹—': [
                {'name': 'é©¬ä¸‰ç«‹ & äºç§€ç', 'story': 'ç›¸å£°è‰ºæœ¯å®¶çš„ä¼ ç»Ÿå®¶åº­', 'traits': 'ç›¸å£°ä¼ ç»Ÿï¼Œæ´¥é—¨é£æƒ…'}
            ],
            'çŒ´çŒª': [
                {'name': 'åå›æ­¦ & å¼ ç', 'story': 'æ¼«ç”»å®¶çš„å¹½é»˜äººç”Ÿ', 'traits': 'æ¼«ç”»è‰ºæœ¯ï¼Œå¹½é»˜æ™ºæ…§'}
            ],
            
            # é¸¡å¹´é…å¯¹
            'é¸¡ç‹—': [
                {'name': 'å¸¸é¦™ç‰ & é™ˆå®ªç« ', 'story': 'è±«å‰§å¤§å¸ˆçš„æˆæ›²äººç”Ÿ', 'traits': 'è±«å‰§è‰ºæœ¯ï¼Œæˆæ›²ä¼ æ‰¿'}
            ],
            'é¸¡çŒª': [
                {'name': 'é©¬è¿è‰¯ & å¤æ·‘ç´', 'story': 'äº¬å‰§å¤§å¸ˆçš„æ¢¨å›­ä¼ å¥‡', 'traits': 'äº¬å‰§å¤§å¸ˆï¼Œæ¢¨å›­ä¸–å®¶'}
            ],
            
            # ç‹—å¹´é…å¯¹
            'ç‹—çŒª': [
                {'name': 'ç½—å®¶ä¼¦ & å¼ ç»´æ¡¢', 'story': 'æ•™è‚²å®¶çš„å­¦è€…å®¶åº­', 'traits': 'æ•™è‚²ç†æƒ³ï¼Œå­¦è€…é£èŒƒ'}
            ],
            
            # åŒç”Ÿè‚–é…å¯¹
            'é¼ é¼ ': [
                {'name': 'èƒ¡è¶ & æ½˜æœ‰å£°', 'story': 'ç”µå½±æ˜æ˜Ÿçš„é“¶å¹•æƒ…ç¼˜', 'traits': 'é“¶å¹•ä½³å¶ï¼Œç”µå½±ä¼ å¥‡'}
            ],
            'ç‰›ç‰›': [
                {'name': 'è°¢æ™‹ & å¾å¤§é›¯', 'story': 'å¯¼æ¼”çš„ç”µå½±äººç”Ÿ', 'traits': 'ç”µå½±è‰ºæœ¯ï¼Œå¯¼æ¼”é£é‡‡'}
            ],
            'è™è™': [
                {'name': 'æŸ³äºšå­ & éƒ‘ä½©å®œ', 'story': 'è¯—äººçš„é©å‘½æƒ…æ€€', 'traits': 'é©å‘½è¯—äººï¼Œæ–‡å­¦ç†æƒ³'}
            ],
            'å…”å…”': [
                {'name': 'å¼ å¤§åƒ & å¾é›¯æ³¢', 'story': 'ç”»å®¶çš„è‰ºæœ¯äººç”Ÿ', 'traits': 'ç»˜ç”»å¤§å¸ˆï¼Œè‰ºæœ¯é£é‡‡'}
            ],
            'é¾™é¾™': [
                {'name': 'æ¢æ¼±æºŸ & é»„é–è´¤', 'story': 'å“²å­¦å®¶çš„ç†æƒ³å®¶åº­', 'traits': 'å“²å­¦æ€è¾¨ï¼Œä¹¡æ‘å»ºè®¾'}
            ],
            'è›‡è›‡': [
                {'name': 'æ—è¯­å ‚ & å»–ç¿ å‡¤', 'story': 'æ–‡å­¦å®¶çš„ä¸œè¥¿æ–‡åŒ–èåˆ', 'traits': 'æ–‡åŒ–èåˆï¼Œå¹½é»˜æ™ºæ…§'}
            ],
            'é©¬é©¬': [
                {'name': 'å¼ å­¦è‰¯ & äºå‡¤è‡³', 'story': 'å°‘å¸…çš„ä¼ å¥‡äººç”Ÿ', 'traits': 'å°‘å¸…é£é‡‡ï¼Œå†å²ä¼ å¥‡'}
            ],
            'ç¾Šç¾Š': [
                {'name': 'åˆ˜æµ·ç²Ÿ & å¤ä¼Šä¹”', 'story': 'ç”»å®¶çš„è‰ºæœ¯è¿½æ±‚', 'traits': 'ç»˜ç”»è‰ºæœ¯ï¼Œè¥¿ç”»å…ˆé©±'}
            ],
            'çŒ´çŒ´': [
                {'name': 'èµµå…ƒä»» & æ¨æ­¥ä¼Ÿ', 'story': 'è¯­è¨€å­¦å®¶çš„å­¦è€…å®¶åº­', 'traits': 'è¯­è¨€å­¦æœ¯ï¼Œå¹½é»˜é£è¶£'}
            ],
            'é¸¡é¸¡': [
                {'name': 'ç‹å®ç”« & ææ¸…ç…§', 'story': '(è™šæ„ç¤ºä¾‹)æ–‡å­¦æ‰å­ä½³äºº', 'traits': 'æ–‡å­¦æ‰åï¼Œè¯—è¯ä¼ æ‰¿'}
            ],
            'ç‹—ç‹—': [
                {'name': 'è®¸åœ°å±± & å‘¨ä¿Ÿæ¾', 'story': 'ä½œå®¶çš„æ–‡å­¦ç†æƒ³', 'traits': 'æ–‡å­¦åˆ›ä½œï¼Œå—æ´‹é£æƒ…'}
            ],
            'çŒªçŒª': [
                {'name': 'æ—å¾½å› çˆ¶æ¯', 'story': 'å»ºç­‘ä¸–å®¶çš„æ–‡åŒ–ä¼ æ‰¿', 'traits': 'å»ºç­‘æ–‡åŒ–ï¼Œå®¶æ—ä¼ æ‰¿'}
            ]
        }
    
    def calculate_emotion_score(self, male: str, female: str) -> int:
        """è®¡ç®—æ„Ÿæƒ…åŒ¹é…åº¦ (30%)"""
        return self.emotion_matrix.get(male, {}).get(female, 70)
    
    def calculate_personality_score(self, male: str, female: str) -> int:
        """è®¡ç®—æ€§æ ¼äº’è¡¥åº¦ (25%)"""
        male_traits = self.personality_traits.get(male, {'active': 7, 'smart': 7, 'social': 7, 'stable': 7})
        female_traits = self.personality_traits.get(female, {'active': 7, 'smart': 7, 'social': 7, 'stable': 7})
        
        # è®¡ç®—å„ç»´åº¦å·®å€¼
        active_diff = abs(male_traits['active'] - female_traits['active'])
        smart_diff = abs(male_traits['smart'] - female_traits['smart'])
        social_diff = abs(male_traits['social'] - female_traits['social'])
        stable_diff = abs(male_traits['stable'] - female_traits['stable'])
        
        # æœ€ä½³å·®å€¼ä¸º2.5ï¼ˆé€‚åº¦äº’è¡¥ï¼‰
        optimal_diff = 2.5
        active_score = max(0, 100 - abs(active_diff - optimal_diff) * 15)
        smart_score = max(0, 100 - abs(smart_diff - optimal_diff) * 15)
        social_score = max(0, 100 - abs(social_diff - optimal_diff) * 15)
        stable_score = max(0, 100 - abs(stable_diff - optimal_diff) * 15)
        
        return round((active_score + smart_score + social_score + stable_score) / 4)
    
    def calculate_career_score(self, male: str, female: str) -> int:
        """è®¡ç®—äº‹ä¸šåè°ƒåº¦ (20%)"""
        key1 = male + female
        key2 = female + male
        return self.career_compatibility.get(key1, self.career_compatibility.get(key2, 70))
    
    def calculate_lifestyle_score(self, male: str, female: str) -> int:
        """è®¡ç®—ç”Ÿæ´»ä¹ æƒ¯åŒ¹é…åº¦ (15%)"""
        return self.lifestyle_matrix.get(male, {}).get(female, 70)
    
    def calculate_communication_score(self, male: str, female: str) -> int:
        """è®¡ç®—æ²Ÿé€šé»˜å¥‘åº¦ (10%)"""
        key1 = male + female
        key2 = female + male
        return self.communication_matrix.get(key1, self.communication_matrix.get(key2, 70))
    
    def get_famous_couples(self, male: str, female: str) -> List[Dict]:
        """è·å–å†å²åäººæ¡ˆä¾‹"""
        key1 = male + female
        key2 = female + male
        couples = self.famous_couples.get(key1, self.famous_couples.get(key2, []))
        
        # å¦‚æœæ²¡æœ‰ä¸“é—¨çš„æ¡ˆä¾‹ï¼Œè¿”å›é€šç”¨æ¡ˆä¾‹
        if not couples:
            couples = [
                {'name': 'ä¼ è¯´ä¸­çš„ä½³å¶', 'story': f'{male}å’Œ{female}çš„é…å¯¹åœ¨å†å²ä¸Šä¹Ÿæœ‰ä¸å°‘ä½³è¯', 'traits': 'ç›¸äº’ç†è§£ï¼Œå…±åŒæˆé•¿'}
            ]
        
        return couples
    
    def get_compatibility_level(self, score: int) -> Tuple[str, str]:
        """æ ¹æ®åˆ†æ•°è·å–åŒ¹é…ç­‰çº§å’Œè¡¨æƒ…"""
        if score >= 90:
            return "å¤©ä½œä¹‹åˆ", "ğŸ’•"
        elif score >= 80:
            return "éå¸¸åŒ¹é…", "ğŸ˜"
        elif score >= 70:
            return "è¾ƒå¥½åŒ¹é…", "ğŸ˜Š"
        elif score >= 60:
            return "ä¸€èˆ¬åŒ¹é…", "ğŸ™‚"
        else:
            return "éœ€è¦åŠªåŠ›", "ğŸ˜"
    
    def generate_analysis_text(self, male: str, female: str, scores: Dict) -> str:
        """ç”Ÿæˆè¯¦ç»†çš„é…å¯¹åˆ†ææ–‡æœ¬"""
        level, _ = self.get_compatibility_level(scores['overall'])
        
        analysis_templates = {
            "å¤©ä½œä¹‹åˆ": f"{male}å’Œ{female}æ˜¯ä¼ è¯´ä¸­çš„å®Œç¾é…å¯¹ï¼Œå„æ–¹é¢éƒ½éå¸¸å’Œè°ã€‚æ„Ÿæƒ…æ·±åšï¼Œæ€§æ ¼äº’è¡¥ï¼Œäº‹ä¸šä¸Šèƒ½å¤Ÿç›¸äº’æ”¯æŒï¼Œç”Ÿæ´»ä¹ æƒ¯åè°ƒï¼Œæ²Ÿé€šé»˜å¥‘ã€‚è¿™æ ·çš„é…å¯¹å ªç§°å¤©ä½œä¹‹åˆï¼Œæ˜¯ä¼—äººç¾¡æ…•çš„ç¥ä»™ä¼´ä¾£ã€‚",
            "éå¸¸åŒ¹é…": f"{male}å’Œ{female}çš„é…å¯¹éå¸¸ç†æƒ³ï¼Œå½¼æ­¤ä¹‹é—´æœ‰ç€å¾ˆå¼ºçš„å¸å¼•åŠ›å’Œäº’è¡¥æ€§ã€‚åœ¨å¤§éƒ¨åˆ†æ–¹é¢éƒ½èƒ½å¤Ÿå’Œè°ç›¸å¤„ï¼Œå¶å°”çš„å°åˆ†æ­§åè€Œèƒ½å¢è¿›å½¼æ­¤çš„äº†è§£ã€‚è¿™æ˜¯ä¸€å¯¹è®©äººçœ‹å¥½çš„ä½³å¶ã€‚",
            "è¾ƒå¥½åŒ¹é…": f"{male}å’Œ{female}çš„é…å¯¹æ•´ä½“æ¥è¯´æ˜¯æ¯”è¾ƒåˆé€‚çš„ï¼Œè™½ç„¶å¯èƒ½åœ¨æŸäº›æ–¹é¢éœ€è¦ç£¨åˆï¼Œä½†åªè¦ç›¸äº’ç†è§£å’ŒåŒ…å®¹ï¼Œå°±èƒ½å»ºç«‹ç¨³å®šå¹¸ç¦çš„å…³ç³»ã€‚æ—¶é—´ä¼šè®©è¿™ä»½æ„Ÿæƒ…æ›´åŠ æ·±åšã€‚",
            "ä¸€èˆ¬åŒ¹é…": f"{male}å’Œ{female}çš„é…å¯¹å±äºä¸­ç­‰æ°´å¹³ï¼Œéœ€è¦åŒæ–¹éƒ½ä»˜å‡ºæ›´å¤šçš„åŠªåŠ›æ¥ç»´æŠ¤è¿™æ®µå…³ç³»ã€‚é€šè¿‡åŠ å¼ºæ²Ÿé€šå’Œç›¸äº’äº†è§£ï¼Œå®Œå…¨æœ‰å¯èƒ½å‘å±•å‡ºç¾å¥½çš„æ„Ÿæƒ…ã€‚",
            "éœ€è¦åŠªåŠ›": f"{male}å’Œ{female}çš„é…å¯¹é¢ä¸´ä¸€äº›æŒ‘æˆ˜ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€ä¸å¯èƒ½ã€‚çœŸæ­£çš„çˆ±æƒ…èƒ½å¤Ÿå…‹æœä¸€åˆ‡å›°éš¾ï¼Œåªè¦åŒæ–¹éƒ½æ„¿æ„ä¸ºå¯¹æ–¹æ”¹å˜å’ŒåŠªåŠ›ï¼ŒåŒæ ·å¯ä»¥æ”¶è·å¹¸ç¦ã€‚"
        }
        
        return analysis_templates.get(level, f"{male}å’Œ{female}çš„é…å¯¹æœ‰ç€ç‹¬ç‰¹çš„é­…åŠ›ï¼Œéœ€è¦ç”¨å¿ƒç»è¥ã€‚")
    
    def generate_advantages(self, male: str, female: str, scores: Dict) -> str:
        """ç”Ÿæˆä¼˜åŠ¿ç‰¹ç‚¹"""
        advantages = []
        
        if scores['emotion'] >= 80:
            advantages.append("æƒ…æ„ŸåŸºç¡€æ·±åšï¼Œå®¹æ˜“äº§ç”Ÿå…±é¸£")
        if scores['personality'] >= 80:
            advantages.append("æ€§æ ¼äº’è¡¥æ€§å¼ºï¼Œèƒ½å¤Ÿç›¸äº’æˆå°±")
        if scores['career'] >= 80:
            advantages.append("äº‹ä¸šå‘å±•åè°ƒï¼Œèƒ½å¤Ÿå…±åŒè¿›æ­¥")
        if scores['lifestyle'] >= 80:
            advantages.append("ç”Ÿæ´»ä¹ æƒ¯ç›¸è¿‘ï¼Œæ—¥å¸¸ç›¸å¤„å’Œè°")
        if scores['communication'] >= 80:
            advantages.append("æ²Ÿé€šé¡ºç•…ï¼Œå¾ˆå°‘äº§ç”Ÿè¯¯è§£")
        
        if not advantages:
            advantages = ["å½¼æ­¤å¸å¼•åŠ›å¼º", "æœ‰å…±åŒè¯é¢˜", "ç›¸å¤„è½»æ¾æ„‰å¿«"]
        
        return "ï¼›".join(advantages) + "ã€‚"
    
    def generate_challenges(self, male: str, female: str, scores: Dict) -> str:
        """ç”Ÿæˆæ³¨æ„äº‹é¡¹"""
        challenges = []
        
        if scores['emotion'] < 70:
            challenges.append("éœ€è¦åŠ å¼ºæƒ…æ„Ÿäº¤æµï¼ŒåŸ¹å…»å…±åŒå…´è¶£")
        if scores['personality'] < 70:
            challenges.append("æ€§æ ¼å·®å¼‚è¾ƒå¤§ï¼Œéœ€è¦æ›´å¤šç†è§£å’ŒåŒ…å®¹")
        if scores['career'] < 70:
            challenges.append("äº‹ä¸šè§„åˆ’å¯èƒ½å­˜åœ¨åˆ†æ­§ï¼Œéœ€è¦åè°ƒç»Ÿä¸€")
        if scores['lifestyle'] < 70:
            challenges.append("ç”Ÿæ´»ä¹ æƒ¯å·®å¼‚éœ€è¦ç£¨åˆ")
        if scores['communication'] < 70:
            challenges.append("æ²Ÿé€šæ–¹å¼éœ€è¦è°ƒæ•´ï¼Œé¿å…è¯¯è§£")
        
        if not challenges:
            challenges = ["ä¿æŒç°æœ‰çš„å’Œè°çŠ¶æ€", "ç»§ç»­åŠ æ·±å½¼æ­¤äº†è§£"]
        
        return "ï¼›".join(challenges) + "ã€‚"
    
    def generate_suggestions(self, male: str, female: str, scores: Dict) -> str:
        """ç”Ÿæˆç›¸å¤„å»ºè®®"""
        suggestions = []
        
        if scores['overall'] >= 85:
            suggestions.extend(["çæƒœè¿™ä»½éš¾å¾—çš„ç¼˜åˆ†", "å…±åŒè§„åˆ’ç¾å¥½æœªæ¥", "ä¿æŒå¼€æ”¾çš„æ²Ÿé€š"])
        elif scores['overall'] >= 75:
            suggestions.extend(["ç»§ç»­åŠ æ·±ç›¸äº’äº†è§£", "åœ¨å·®å¼‚ä¸­å¯»æ‰¾äº’è¡¥", "åŸ¹å…»å…±åŒçˆ±å¥½"])
        elif scores['overall'] >= 65:
            suggestions.extend(["å¤šèŠ±æ—¶é—´ç›¸å¤„", "å­¦ä¼šæ¢ä½æ€è€ƒ", "å»ºç«‹æœ‰æ•ˆçš„æ²Ÿé€šæœºåˆ¶"])
        else:
            suggestions.extend(["éœ€è¦æ›´å¤šè€å¿ƒå’Œç†è§£", "å¯»æ‰¾å…±åŒç‚¹", "ä¸“æ³¨äºå¯¹æ–¹çš„ä¼˜ç‚¹"])
        
        suggestions.append("è®°ä½çˆ±æƒ…éœ€è¦åŒæ–¹çš„åŠªåŠ›")
        
        return "ï¼›".join(suggestions) + "ã€‚"
    
    def calculate_comprehensive_match(self, male: str, female: str) -> Dict[str, Any]:
        """è®¡ç®—ç»¼åˆé…å¯¹ç»“æœ"""
        try:
            # éªŒè¯ç”Ÿè‚–æœ‰æ•ˆæ€§
            if male not in self.zodiac_list or female not in self.zodiac_list:
                raise ValueError(f"æ— æ•ˆçš„ç”Ÿè‚–ï¼š{male}, {female}")
            
            # è®¡ç®—å„ç»´åº¦åˆ†æ•°
            emotion_score = self.calculate_emotion_score(male, female)
            personality_score = self.calculate_personality_score(male, female)
            career_score = self.calculate_career_score(male, female)
            lifestyle_score = self.calculate_lifestyle_score(male, female)
            communication_score = self.calculate_communication_score(male, female)
            
            # è®¡ç®—åŠ æƒæ€»åˆ†
            overall_score = round(
                emotion_score * 0.3 + 
                personality_score * 0.25 + 
                career_score * 0.2 + 
                lifestyle_score * 0.15 + 
                communication_score * 0.1
            )
            
            # ç»„ç»‡è¯„åˆ†æ•°æ®
            scores = {
                'emotion': emotion_score,
                'personality': personality_score,
                'career': career_score,
                'lifestyle': lifestyle_score,
                'communication': communication_score,
                'overall': overall_score
            }
            
            # è·å–åŒ¹é…ç­‰çº§å’Œè¡¨æƒ…
            level, emoji = self.get_compatibility_level(overall_score)
            
            # ç”Ÿæˆæ–‡æœ¬å†…å®¹
            analysis = self.generate_analysis_text(male, female, scores)
            advantages = self.generate_advantages(male, female, scores)
            challenges = self.generate_challenges(male, female, scores)
            suggestions = self.generate_suggestions(male, female, scores)
            
            # è·å–å†å²åäººæ¡ˆä¾‹
            famous_couples = self.get_famous_couples(male, female)
            
            # ç»„è£…æœ€ç»ˆç»“æœ
            result = {
                'zodiac_pair': f'{male}{female}',
                'male_zodiac': male,
                'female_zodiac': female,
                'overall_score': overall_score,
                'compatibility_level': level,
                'emoji': emoji,
                'scores': scores,
                'analysis': analysis,
                'advantages': advantages,
                'challenges': challenges,
                'suggestions': suggestions,
                'famous_couples': famous_couples,
                'calculation_method': 'å¤šç»´åº¦è¯„åˆ†ä½“ç³»',
                'dimensions': {
                    'æ„Ÿæƒ…åŒ¹é…åº¦': f'{emotion_score}åˆ† (æƒé‡30%)',
                    'æ€§æ ¼äº’è¡¥åº¦': f'{personality_score}åˆ† (æƒé‡25%)',
                    'äº‹ä¸šåè°ƒåº¦': f'{career_score}åˆ† (æƒé‡20%)',
                    'ç”Ÿæ´»ä¹ æƒ¯': f'{lifestyle_score}åˆ† (æƒé‡15%)',
                    'æ²Ÿé€šé»˜å¥‘åº¦': f'{communication_score}åˆ† (æƒé‡10%)'
                },
                'timestamp': datetime.now().isoformat()
            }
            
            return result
            
        except Exception as e:
            # é”™è¯¯å¤„ç†
            return {
                'error': True,
                'message': f'è®¡ç®—é…å¯¹ç»“æœæ—¶å‡ºé”™ï¼š{str(e)}',
                'zodiac_pair': f'{male}{female}',
                'male_zodiac': male,
                'female_zodiac': female,
                'timestamp': datetime.now().isoformat()
            }

# åˆ›å»ºå…¨å±€å®ä¾‹
zodiac_matcher = ZodiacMatcher()

def calculate_zodiac_compatibility(male_zodiac: str, female_zodiac: str) -> Dict[str, Any]:
    """
    è®¡ç®—ç”Ÿè‚–é…å¯¹å…¼å®¹æ€§çš„ä¸»è¦æ¥å£å‡½æ•°
    
    Args:
        male_zodiac (str): ç”·æ–¹ç”Ÿè‚–
        female_zodiac (str): å¥³æ–¹ç”Ÿè‚–
    
    Returns:
        Dict[str, Any]: åŒ…å«è¯¦ç»†é…å¯¹åˆ†æçš„ç»“æœå­—å…¸
    """
    return zodiac_matcher.calculate_comprehensive_match(male_zodiac, female_zodiac)

# æµ‹è¯•å‡½æ•°
def test_zodiac_matching():
    """æµ‹è¯•ç”Ÿè‚–é…å¯¹ç®—æ³•"""
    test_cases = [
        ('ç‰›', 'çŒª'),
        ('é¼ ', 'é¾™'),
        ('è™', 'çŒª'),
        ('å…”', 'ç‹—'),
        ('é¾™', 'é¸¡'),
        ('è›‡', 'çŒ´')
    ]
    
    print("=== ç”Ÿè‚–é…å¯¹ç®—æ³•æµ‹è¯• ===")
    for male, female in test_cases:
        result = calculate_zodiac_compatibility(male, female)
        if not result.get('error'):
            print(f"\n{male} + {female}:")
            print(f"  æ€»åˆ†: {result['overall_score']}åˆ†")
            print(f"  ç­‰çº§: {result['compatibility_level']} {result['emoji']}")
            print(f"  å„ç»´åº¦: æ„Ÿæƒ…{result['scores']['emotion']} | æ€§æ ¼{result['scores']['personality']} | äº‹ä¸š{result['scores']['career']} | ç”Ÿæ´»{result['scores']['lifestyle']} | æ²Ÿé€š{result['scores']['communication']}")
            if result['famous_couples']:
                print(f"  åäººæ¡ˆä¾‹: {result['famous_couples'][0]['name']}")
        else:
            print(f"é”™è¯¯: {result['message']}")

if __name__ == "__main__":
    test_zodiac_matching()
