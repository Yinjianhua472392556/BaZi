<!--profile.wxml-->
<view class="container">
  <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
  <view class="main-content">
    <!-- åŠŸèƒ½èœå•å¡ç‰‡ -->
    <view class="card">
      <view class="subtitle">åŠŸèƒ½èœå•</view>
      <view class="menu-list">
        <navigator url="/pages/history/history" class="menu-item">
          <view class="menu-icon-wrapper">
            <view class="menu-icon">ğŸ“Š</view>
          </view>
          <view class="menu-content">
            <view class="menu-text">å†å²è®°å½•</view>
            <view class="menu-desc">æŸ¥çœ‹æˆ‘çš„æµ‹ç®—è®°å½•</view>
          </view>
          <view class="menu-arrow">></view>
        </navigator>
        
        <view class="menu-item" bindtap="viewCollectedNames">
          <view class="menu-icon-wrapper">
            <view class="menu-icon">â­</view>
          </view>
          <view class="menu-content">
            <view class="menu-text">æˆ‘çš„æ”¶è—</view>
            <view class="menu-desc">æŸ¥çœ‹æ”¶è—çš„åå­—</view>
          </view>
          <view class="menu-arrow">></view>
        </view>
        
        
        <view class="menu-item" bindtap="aboutApp">
          <view class="menu-icon-wrapper">
            <view class="menu-icon">â„¹ï¸</view>
          </view>
          <view class="menu-content">
            <view class="menu-text">å…³äºå°ç¨‹åº</view>
            <view class="menu-desc">äº†è§£æ›´å¤šä¿¡æ¯</view>
          </view>
          <view class="menu-arrow">></view>
        </view>
      </view>
    </view>


    <!-- å…è´£å£°æ˜ -->
    <view class="disclaimer">
      æœ¬å°ç¨‹åºåŸºäºä¼ ç»Ÿæ–‡åŒ–å¼€å‘ï¼Œæ‰€æœ‰æµ‹ç®—ç»“æœä»…ä¾›å¨±ä¹å‚è€ƒã€‚
    </view>
  </view>

  <!-- æ”¶è—åå­—æ¨¡æ€æ¡† -->
  <view class="collected-modal" wx:if="{{showCollectedModal}}" bindtap="closeCollectedModal">
    <view class="modal-content" catchtap="true">
      <view class="modal-header">
        <view class="modal-title">æˆ‘çš„æ”¶è—</view>
        <view class="modal-close" bindtap="closeCollectedModal">Ã—</view>
      </view>
      
      <view class="modal-body">
        <!-- æ¨ªå¹…å¹¿å‘Š - å·²éšè—ï¼ˆå¾®ä¿¡å¹¿å‘Šç³»ç»Ÿè‡ªå·±é›†æˆï¼‰ -->

        <view wx:if="{{collectedNames.length === 0}}" class="empty-state">
          <view class="empty-icon">ğŸ“</view>
          <view class="empty-text">æš‚æ— æ”¶è—çš„åå­—</view>
          <view class="empty-desc">å»èµ·åé¡µé¢æ”¶è—å–œæ¬¢çš„åå­—å§</view>
        </view>
        
        <view wx:else class="collected-list">
          <view 
            class="collected-item"
            wx:for="{{collectedNames}}"
            wx:key="full_name"
          >
            <view class="collected-main">
              <view class="collected-name">{{item.full_name}}</view>
              <view class="collected-score">
                <text class="score-number">{{item.overall_score}}</text>
                <text class="score-label">åˆ†</text>
              </view>
            </view>
            <view class="collected-info">
              <view class="collected-pronunciation">{{item.pronunciation}}</view>
              <view class="collected-luck">{{item.luck_level}}</view>
            </view>
            <view class="collected-meaning">{{item.meaning_explanation}}</view>
            <view class="collected-time">æ”¶è—æ—¶é—´ï¼š{{item.collected_time_formatted}}</view>
            
            <view class="collected-actions">
              <button 
                class="action-btn view-detail-btn"
                bindtap="viewCollectedDetail"
                data-index="{{index}}"
              >
                æŸ¥çœ‹è¯¦æƒ…
              </button>
              <button 
                class="action-btn remove-btn"
                bindtap="removeCollected"
                data-index="{{index}}"
              >
                å–æ¶ˆæ”¶è—
              </button>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ”¶è—åå­—è¯¦æƒ…æ¨¡æ€æ¡† -->
  <view class="name-detail-modal" wx:if="{{showCollectedDetail}}" bindtap="closeCollectedDetail">
    <view class="modal-content" catchtap="true">
      <view class="modal-header">
        <view class="modal-title">{{selectedCollectedName.full_name}}</view>
        <view class="modal-close" bindtap="closeCollectedDetail">Ã—</view>
      </view>
      
      <view class="modal-body">
        <view class="detail-section">
          <view class="detail-title">åŸºæœ¬ä¿¡æ¯</view>
          <view class="detail-row">
            <text class="detail-label">å®Œæ•´å§“åï¼š</text>
            <text class="detail-value">{{selectedCollectedName.full_name}}</text>
          </view>
          <view class="detail-row">
            <text class="detail-label">æ‹¼éŸ³ï¼š</text>
            <text class="detail-value">{{selectedCollectedName.pronunciation}}</text>
          </view>
          <view class="detail-row">
            <text class="detail-label">ç»¼åˆè¯„åˆ†ï¼š</text>
            <text class="detail-value score">{{selectedCollectedName.overall_score}}åˆ†</text>
          </view>
          <view class="detail-row">
            <text class="detail-label">å‰å‡¶ç­‰çº§ï¼š</text>
            <text class="detail-value luck">{{selectedCollectedName.luck_level}}</text>
          </view>
          <view class="detail-row">
            <text class="detail-label">æ”¶è—æ—¶é—´ï¼š</text>
            <text class="detail-value">{{selectedCollectedName.collected_time_formatted}}</text>
          </view>
        </view>

        <view class="detail-section" wx:if="{{selectedCollectedName.wuxing_analysis}}">
          <view class="detail-title">äº”è¡Œåˆ†æ</view>
          <view class="wuxing-chars">
            <view 
              class="wuxing-char"
              wx:for="{{selectedCollectedName.wuxing_analysis.chars_wuxing}}"
              wx:key="char"
            >
              <view class="char-text">{{item.char}}</view>
              <view class="char-wuxing">{{item.wuxing}}</view>
            </view>
          </view>
        </view>

        <view class="detail-section" wx:if="{{selectedCollectedName.sancai_wuge}}">
          <view class="detail-title">ä¸‰æ‰äº”æ ¼</view>
          <view class="wuge-grid">
            <view 
              class="wuge-item"
              wx:for="{{selectedCollectedName.sancai_wuge.wuge_analysis}}"
              wx:for-item="wuge"
              wx:for-index="wugeName"
              wx:key="*this"
            >
              <view class="wuge-name">{{wugeName}}</view>
              <view class="wuge-value">{{wuge.value}}</view>
              <view class="wuge-wuxing">{{wuge.wuxing}}</view>
              <view class="wuge-luck">{{wuge.luck.luck}}</view>
            </view>
          </view>
        </view>

        <view class="detail-section" wx:if="{{selectedCollectedName.score_breakdown}}">
          <view class="detail-title">è¯„åˆ†æ„æˆåˆ†æ</view>
          <view class="score-breakdown">
            <view class="score-item">
              <view class="score-label">äº”æ ¼å¾—åˆ† ({{selectedCollectedName.score_breakdown.weights.wuge_weight}}%)</view>
              <view class="score-bar">
                <view class="score-fill" style="width: {{selectedCollectedName.score_breakdown.wuge_score}}%;"></view>
                <view class="score-text">{{selectedCollectedName.score_breakdown.wuge_score}}åˆ†</view>
              </view>
            </view>
            
            <view class="score-item">
              <view class="score-label">äº”è¡ŒåŒ¹é… ({{selectedCollectedName.score_breakdown.weights.wuxing_weight}}%)</view>
              <view class="score-bar">
                <view class="score-fill" style="width: {{selectedCollectedName.score_breakdown.wuxing_match_score}}%;"></view>
                <view class="score-text">{{selectedCollectedName.score_breakdown.wuxing_match_score}}åˆ†</view>
              </view>
            </view>
            
            <view class="score-item">
              <view class="score-label">ä¸‰æ‰é…ç½® ({{selectedCollectedName.score_breakdown.weights.sancai_weight}}%)</view>
              <view class="score-bar">
                <view class="score-fill" style="width: {{selectedCollectedName.score_breakdown.sancai_score}}%;"></view>
                <view class="score-text">{{selectedCollectedName.score_breakdown.sancai_score}}åˆ†</view>
              </view>
            </view>
            
            <view class="score-item">
              <view class="score-label">éŸ³éŸµå’Œè° ({{selectedCollectedName.score_breakdown.weights.phonetic_weight}}%)</view>
              <view class="score-bar">
                <view class="score-fill" style="width: {{selectedCollectedName.score_breakdown.phonetic_score}}%;"></view>
                <view class="score-text">{{selectedCollectedName.score_breakdown.phonetic_score}}åˆ†</view>
              </view>
            </view>
            
            <view class="score-item">
              <view class="score-label">å¯“æ„ä¸°å¯Œ ({{selectedCollectedName.score_breakdown.weights.meaning_weight}}%)</view>
              <view class="score-bar">
                <view class="score-fill" style="width: {{selectedCollectedName.score_breakdown.meaning_score}}%;"></view>
                <view class="score-text">{{selectedCollectedName.score_breakdown.meaning_score}}åˆ†</view>
              </view>
            </view>
          </view>
        </view>

        <view class="detail-section">
          <view class="detail-title">å¯“æ„è§£é‡Š</view>
          <view class="meaning-text">{{selectedCollectedName.meaning_explanation}}</view>
        </view>
      </view>
    </view>
  </view>
</view>
