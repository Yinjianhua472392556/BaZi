<view class="container">
  <view class="page-header">
    <view class="page-title-container">
      <view class="page-title">æ™ºèƒ½èµ·å</view>
      <view class="page-subtitle">åŸºäºå…«å­—äº”è¡Œçš„ä¸“ä¸šèµ·å</view>
    </view>
    <view class="page-decoration">ğŸŒŸ</view>
  </view>

  <view class="main-content" wx:if="{{!showResults}}">
    <view class="form-card">
      <view class="form-group">
        <view class="form-title">åŸºæœ¬ä¿¡æ¯</view>
        
        <view class="input-row">
          <view class="input-label">å§“æ°</view>
          <input 
            class="input-field" 
            placeholder="è¯·è¾“å…¥å§“æ°"
            value="{{surname}}"
            bindinput="onSurnameInput"
            maxlength="3"
          />
        </view>

        <view class="input-row">
          <view class="input-label">æ€§åˆ«</view>
          <picker 
            bindchange="onGenderChange" 
            range="{{genderOptions}}"
            range-key="text"
          >
            <view class="picker-display">
              {{genderOptions[0].text}}
              <text class="picker-arrow">â–¼</text>
            </view>
          </picker>
        </view>
      </view>

      <view class="form-group">
        <view class="form-title">å‡ºç”Ÿä¿¡æ¯</view>
        
        <view class="input-row">
          <view class="input-label">å†æ³•</view>
          <picker 
            bindchange="onCalendarTypeChange" 
            range="{{calendarOptions}}"
            range-key="text"
          >
            <view class="picker-display">
              {{calendarOptions[0].text}}
              <text class="picker-arrow">â–¼</text>
            </view>
          </picker>
        </view>

        <view class="date-inputs">
          <view class="date-input-group">
            <input 
              class="date-input" 
              placeholder="å¹´"
              value="{{birthYear}}"
              bindinput="onBirthYearInput"
              type="number"
            />
            <text class="date-label">å¹´</text>
          </view>
          <view class="date-input-group">
            <input 
              class="date-input" 
              placeholder="æœˆ"
              value="{{birthMonth}}"
              bindinput="onBirthMonthInput"
              type="number"
            />
            <text class="date-label">æœˆ</text>
          </view>
          <view class="date-input-group">
            <input 
              class="date-input" 
              placeholder="æ—¥"
              value="{{birthDay}}"
              bindinput="onBirthDayInput"
              type="number"
            />
            <text class="date-label">æ—¥</text>
          </view>
        </view>

        <view class="input-row">
          <view class="input-label">æ—¶è¾°</view>
          <picker 
            bindchange="onHourChange" 
            range="{{hourOptions}}"
            range-key="text"
          >
            <view class="picker-display">
              {{hourOptions[6].text}}
              <text class="picker-arrow">â–¼</text>
            </view>
          </picker>
        </view>
      </view>

      <view class="form-group">
        <view class="form-title">èµ·ååå¥½</view>
        
        <view class="input-row">
          <view class="input-label">å­—æ•°</view>
          <picker 
            bindchange="onNameLengthChange" 
            range="{{nameLengthOptions}}"
            range-key="text"
          >
            <view class="picker-display">
              {{nameLengthOptions[1].text}}
              <text class="picker-arrow">â–¼</text>
            </view>
          </picker>
        </view>
      </view>

      <view class="action-section">
        <button 
          class="start-naming-btn {{analyzing ? 'loading' : ''}}"
          bindtap="startNaming"
          disabled="{{analyzing}}"
        >
          <text wx:if="{{!analyzing}}">å¼€å§‹èµ·å</text>
          <text wx:else>æ­£åœ¨åˆ†æä¸­...</text>
        </button>
      </view>
    </view>
  </view>

  <view class="results-section" wx:if="{{showResults}}">
    <view class="analysis-card">
      <view class="analysis-title">å…«å­—äº”è¡Œåˆ†æ</view>
      <view class="analysis-content">{{analysisSummary}}</view>
      <view class="naming-suggestions">{{namingSuggestions}}</view>
    </view>

    <view class="names-list">
      <view class="list-title">æ¨èåå­—</view>
      <view 
        class="name-item"
        wx:for="{{recommendations}}"
        wx:key="full_name"
        bindtap="viewNameDetail"
        data-index="{{index}}"
      >
        <view class="name-main">
          <view class="name-text">{{item.full_name}}</view>
          <view class="name-score">
            <text class="score-number">{{item.overall_score}}</text>
            <text class="score-label">åˆ†</text>
          </view>
        </view>
        <view class="name-info">
          <view class="name-pronunciation">{{item.pronunciation}}</view>
          <view class="name-luck">{{item.luck_level}}</view>
        </view>
        <view class="name-meaning">{{item.meaning_explanation}}</view>
        
        <view class="name-actions">
          <button 
            class="action-btn collect-btn"
            bindtap="collectName"
            data-index="{{index}}"
            catchtap="true"
          >
            æ”¶è—
          </button>
          <button 
            class="action-btn share-btn"
            bindtap="shareName"
            data-index="{{index}}"
            catchtap="true"
          >
            åˆ†äº«
          </button>
        </view>
      </view>
    </view>

    <view class="restart-section">
      <button class="restart-btn" bindtap="restartNaming">
        é‡æ–°èµ·å
      </button>
    </view>
  </view>

  <view class="name-detail-modal" wx:if="{{showNameDetail}}" bindtap="closeNameDetail">
    <view class="modal-content" catchtap="true">
      <view class="modal-header">
        <view class="modal-title">{{selectedName.full_name}}</view>
        <view class="modal-close" bindtap="closeNameDetail">Ã—</view>
      </view>
      
      <view class="modal-body">
        <view class="detail-section">
          <view class="detail-title">åŸºæœ¬ä¿¡æ¯</view>
          <view class="detail-row">
            <text class="detail-label">å®Œæ•´å§“åï¼š</text>
            <text class="detail-value">{{selectedName.full_name}}</text>
          </view>
          <view class="detail-row">
            <text class="detail-label">æ‹¼éŸ³ï¼š</text>
            <text class="detail-value">{{selectedName.pronunciation}}</text>
          </view>
          <view class="detail-row">
            <text class="detail-label">ç»¼åˆè¯„åˆ†ï¼š</text>
            <text class="detail-value score">{{selectedName.overall_score}}åˆ†</text>
          </view>
          <view class="detail-row">
            <text class="detail-label">å‰å‡¶ç­‰çº§ï¼š</text>
            <text class="detail-value luck">{{selectedName.luck_level}}</text>
          </view>
        </view>

        <view class="detail-section">
          <view class="detail-title">äº”è¡Œåˆ†æ</view>
          <view class="wuxing-chars">
            <view 
              class="wuxing-char"
              wx:for="{{selectedName.wuxing_analysis.chars_wuxing}}"
              wx:key="char"
            >
              <view class="char-text">{{item.char}}</view>
              <view class="char-wuxing">{{item.wuxing}}</view>
            </view>
          </view>
        </view>

        <view class="detail-section">
          <view class="detail-title">ä¸‰æ‰äº”æ ¼</view>
          <view class="wuge-grid">
            <view 
              class="wuge-item"
              wx:for="{{selectedName.sancai_wuge.wuge_analysis}}"
              wx:for-item="wuge"
              wx:for-index="wugeName"
              wx:key="*this"
            >
              <view class="wuge-name">{{wugeName}}</view>
              <view class="wuge-value">{{wuge.value}}</view>
              <view class="wuge-wuxing">{{wuge.wuxing}}</view>
              <view class="wuge-luck">{{wuge.luck.luck}}</view>
            </view>
          </view>
        </view>

        <view class="detail-section">
          <view class="detail-title">å¯“æ„è§£é‡Š</view>
          <view class="meaning-text">{{selectedName.meaning_explanation}}</view>
        </view>
      </view>
    </view>
  </view>

  <view class="disclaimer" wx:if="{{showResults}}">
    <text class="disclaimer-text">
      * èµ·åç»“æœåŸºäºä¼ ç»Ÿäº”è¡Œç†è®ºå’Œå§“åå­¦è®¡ç®—ï¼Œä»…ä¾›å¨±ä¹å‚è€ƒï¼Œä¸å¯ä½œä¸ºäººç”Ÿå†³ç­–ä¾æ®
    </text>
  </view>
</view>
