<!--result.wxml-->
<view class="container">
  <!-- 结果内容区域 -->
  <view class="main-content">
    <!-- 页面标题 -->
    <view class="result-title">八字命理解析</view>
    
    <!-- 信息展示表格 -->
    <view class="info-table">
      <view class="table-row">
        <view class="table-label">
          📅 {{resultData.calendar_type === 'lunar' ? '输入农历' : '公历生日'}}
        </view>
        <view class="table-value">
          {{resultData.calendar_type === 'lunar' ? lunarDate : resultData.user_info.birth_date}}
        </view>
      </view>
      
      <view class="table-row">
        <view class="table-label">
          🗓️ {{resultData.calendar_type === 'lunar' ? '对应公历' : '对应农历'}}
        </view>
        <view class="table-value">
          {{resultData.calendar_type === 'lunar' ? resultData.user_info.birth_date : lunarDate}}
        </view>
      </view>
      
      <view class="table-row">
        <view class="table-label">
          🔮 天干地支
        </view>
        <view class="table-value bazi-text">
          {{baziString || '庚子-乙酉-戊辰-壬子'}}
        </view>
      </view>
      
      <view class="table-row">
        <view class="table-label">
          ⚡ 所属五行
        </view>
        <view class="table-value wuxing-text">
          {{wuxingString || '金水-木金-土土-水水'}}
        </view>
      </view>
      
      <view class="table-row">
        <view class="table-label">
          ⚠️ 五行缺陷
        </view>
        <view class="table-value lack-text">
          {{wuxingLack || '火'}}
        </view>
      </view>
      
      <view class="table-row">
        <view class="table-label">
          🐭 所属生肖
        </view>
        <view class="table-value zodiac-text">
          {{shengxiao || '鼠'}}
        </view>
      </view>
    </view>
    
    <!-- 八字详解说明 -->
    <view class="bazi-explanation">
      天干地支即生辰八字
    </view>
    
    <!-- 操作按钮 -->
    <view class="action-buttons">
      <!-- 主要按钮 - 八字解读 -->
      <button class="btn-primary" bindtap="showAnalysis">
        <text class="btn-icon">🔍</text>八字解读
      </button>
      
      <!-- 次要按钮 - 重新计算 -->
      <button class="btn-secondary" bindtap="calculateAgain">
        <text class="btn-icon">🔄</text>重新计算
      </button>
    </view>
    
    <!-- 广告位 - 已隐藏（微信广告系统自己集成） -->
  </view>
</view>

<!-- 分析结果弹窗 -->
<view class="analysis-modal {{showAnalysisModal ? 'show' : ''}}" bindtap="hideAnalysis">
  <view class="modal-content" catchtap="preventClose">
    <view class="modal-header">
      <view class="modal-title">八字分析结果</view>
      <view class="modal-close" bindtap="hideAnalysis">×</view>
    </view>
    
    <scroll-view class="modal-body" scroll-y="true">
      <!-- 性格分析 -->
      <view class="analysis-section">
        <view class="analysis-title">性格特点</view>
        <view class="analysis-content">{{resultData.analysis.personality || '性格分析内容...'}}</view>
      </view>
      
      <!-- 五行分析 -->
      <view class="analysis-section">
        <view class="analysis-title">五行平衡</view>
        <view class="analysis-content">{{resultData.analysis.wuxing_analysis || '五行分析内容...'}}</view>
      </view>
      
      <!-- 事业运势 -->
      <view class="analysis-section">
        <view class="analysis-title">事业运势</view>
        <view class="analysis-content">{{resultData.analysis.career || '事业分析内容...'}}</view>
      </view>
      
      <!-- 感情运势 -->
      <view class="analysis-section">
        <view class="analysis-title">感情运势</view>
        <view class="analysis-content">{{resultData.analysis.love || '感情分析内容...'}}</view>
      </view>
      
      <!-- 健康运势 -->
      <view class="analysis-section" wx:if="{{resultData.analysis.health}}">
        <view class="analysis-title">健康运势</view>
        <view class="analysis-content">{{resultData.analysis.health}}</view>
      </view>
      
      <!-- 财运分析 -->
      <view class="analysis-section" wx:if="{{resultData.analysis.wealth}}">
        <view class="analysis-title">财运分析</view>
        <view class="analysis-content">{{resultData.analysis.wealth}}</view>
      </view>
      
      <!-- 人际关系 -->
      <view class="analysis-section" wx:if="{{resultData.analysis.relationship}}">
        <view class="analysis-title">人际关系</view>
        <view class="analysis-content">{{resultData.analysis.relationship}}</view>
      </view>
      
      <!-- 年龄特定分析 -->
      <view class="analysis-section" wx:if="{{resultData.analysis.age_specific}}">
        <view class="analysis-title">人生阶段指导</view>
        <view class="analysis-content">{{resultData.analysis.age_specific}}</view>
      </view>
      
      <!-- 流年运势 -->
      <view class="analysis-section" wx:if="{{resultData.analysis.yearly_fortune}}">
        <view class="analysis-title">流年运势</view>
        <view class="analysis-content">{{resultData.analysis.yearly_fortune}}</view>
      </view>
      
      <!-- 今日运势 -->
      <view class="analysis-section">
        <view class="analysis-title">今日运势</view>
        <view class="analysis-content">
          <view class="fortune-score">运势评分：{{resultData.today_fortune.score || 8}}/10</view>
          <view class="fortune-desc">{{resultData.today_fortune.description || '今日运势不错...'}}</view>
        </view>
      </view>

      <!-- 书籍推荐区域 -->
      <view class="book-recommendation-section" wx:if="{{bookRecommendationContext}}">
        <book-recommendation 
          context="{{bookRecommendationContext}}"
          count="{{3}}"
          layout="list"
          title="相关书籍推荐"
          show-title="{{true}}"
          bind:bookclick="onBookClick"
          bind:bookcollect="onBookCollect"
          bind:bookshare="onBookShare">
        </book-recommendation>
      </view>
    </scroll-view>
    
    <view class="modal-footer">
      <button class="btn-save" bindtap="saveToHistory">保存到历史</button>
    </view>
  </view>
</view>
