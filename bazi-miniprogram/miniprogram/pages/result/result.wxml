<!--result.wxml-->
<view class="container">
  <!-- ç»“æœå†…å®¹åŒºåŸŸ -->
  <view class="main-content">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <view class="result-title">å…«å­—å‘½ç†è§£æ</view>
    
    <!-- ä¿¡æ¯å±•ç¤ºè¡¨æ ¼ -->
    <view class="info-table">
      <view class="table-row">
        <view class="table-label">
          ğŸ“… {{resultData.calendar_type === 'lunar' ? 'è¾“å…¥å†œå†' : 'å…¬å†ç”Ÿæ—¥'}}
        </view>
        <view class="table-value">
          {{resultData.calendar_type === 'lunar' ? lunarDate : resultData.user_info.birth_date}}
        </view>
      </view>
      
      <view class="table-row">
        <view class="table-label">
          ğŸ—“ï¸ {{resultData.calendar_type === 'lunar' ? 'å¯¹åº”å…¬å†' : 'å¯¹åº”å†œå†'}}
        </view>
        <view class="table-value">
          {{resultData.calendar_type === 'lunar' ? resultData.user_info.birth_date : lunarDate}}
        </view>
      </view>
      
      <view class="table-row">
        <view class="table-label">
          ğŸ”® å¤©å¹²åœ°æ”¯
        </view>
        <view class="table-value bazi-text">
          {{baziString || 'åºšå­-ä¹™é…‰-æˆŠè¾°-å£¬å­'}}
        </view>
      </view>
      
      <view class="table-row">
        <view class="table-label">
          âš¡ æ‰€å±äº”è¡Œ
        </view>
        <view class="table-value wuxing-text">
          {{wuxingString || 'é‡‘æ°´-æœ¨é‡‘-åœŸåœŸ-æ°´æ°´'}}
        </view>
      </view>
      
      <view class="table-row">
        <view class="table-label">
          âš ï¸ äº”è¡Œç¼ºé™·
        </view>
        <view class="table-value lack-text">
          {{wuxingLack || 'ç«'}}
        </view>
      </view>
      
      <view class="table-row">
        <view class="table-label">
          ğŸ­ æ‰€å±ç”Ÿè‚–
        </view>
        <view class="table-value zodiac-text">
          {{shengxiao || 'é¼ '}}
        </view>
      </view>
    </view>
    
    <!-- å…«å­—è¯¦è§£è¯´æ˜ -->
    <view class="bazi-explanation">
      å¤©å¹²åœ°æ”¯å³ç”Ÿè¾°å…«å­—
    </view>
    
    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-buttons">
      <!-- ä¸»è¦æŒ‰é’® - å…«å­—è§£è¯» -->
      <button class="btn-primary" bindtap="showAnalysis">
        <text class="btn-icon">ğŸ”</text>å…«å­—è§£è¯»
      </button>
      
      <!-- æ¬¡è¦æŒ‰é’® - é‡æ–°è®¡ç®— -->
      <button class="btn-secondary" bindtap="calculateAgain">
        <text class="btn-icon">ğŸ”„</text>é‡æ–°è®¡ç®—
      </button>
    </view>
    
    <!-- å¹¿å‘Šä½ - å·²éšè—ï¼ˆå¾®ä¿¡å¹¿å‘Šç³»ç»Ÿè‡ªå·±é›†æˆï¼‰ -->
  </view>
</view>

<!-- åˆ†æç»“æœå¼¹çª— -->
<view class="analysis-modal {{showAnalysisModal ? 'show' : ''}}" bindtap="hideAnalysis">
  <view class="modal-content" catchtap="preventClose">
    <view class="modal-header">
      <view class="modal-title">å…«å­—åˆ†æç»“æœ</view>
      <view class="modal-close" bindtap="hideAnalysis">Ã—</view>
    </view>
    
    <scroll-view class="modal-body" scroll-y="true">
      <!-- æ€§æ ¼åˆ†æ -->
      <view class="analysis-section">
        <view class="analysis-title">æ€§æ ¼ç‰¹ç‚¹</view>
        <view class="analysis-content">{{resultData.analysis.personality || 'æ€§æ ¼åˆ†æå†…å®¹...'}}</view>
      </view>
      
      <!-- äº”è¡Œåˆ†æ -->
      <view class="analysis-section">
        <view class="analysis-title">äº”è¡Œå¹³è¡¡</view>
        <view class="analysis-content">{{resultData.analysis.wuxing_analysis || 'äº”è¡Œåˆ†æå†…å®¹...'}}</view>
      </view>
      
      <!-- äº‹ä¸šè¿åŠ¿ -->
      <view class="analysis-section">
        <view class="analysis-title">äº‹ä¸šè¿åŠ¿</view>
        <view class="analysis-content">{{resultData.analysis.career || 'äº‹ä¸šåˆ†æå†…å®¹...'}}</view>
      </view>
      
      <!-- æ„Ÿæƒ…è¿åŠ¿ -->
      <view class="analysis-section">
        <view class="analysis-title">æ„Ÿæƒ…è¿åŠ¿</view>
        <view class="analysis-content">{{resultData.analysis.love || 'æ„Ÿæƒ…åˆ†æå†…å®¹...'}}</view>
      </view>
      
      <!-- å¥åº·è¿åŠ¿ -->
      <view class="analysis-section" wx:if="{{resultData.analysis.health}}">
        <view class="analysis-title">å¥åº·è¿åŠ¿</view>
        <view class="analysis-content">{{resultData.analysis.health}}</view>
      </view>
      
      <!-- è´¢è¿åˆ†æ -->
      <view class="analysis-section" wx:if="{{resultData.analysis.wealth}}">
        <view class="analysis-title">è´¢è¿åˆ†æ</view>
        <view class="analysis-content">{{resultData.analysis.wealth}}</view>
      </view>
      
      <!-- äººé™…å…³ç³» -->
      <view class="analysis-section" wx:if="{{resultData.analysis.relationship}}">
        <view class="analysis-title">äººé™…å…³ç³»</view>
        <view class="analysis-content">{{resultData.analysis.relationship}}</view>
      </view>
      
      <!-- å¹´é¾„ç‰¹å®šåˆ†æ -->
      <view class="analysis-section" wx:if="{{resultData.analysis.age_specific}}">
        <view class="analysis-title">äººç”Ÿé˜¶æ®µæŒ‡å¯¼</view>
        <view class="analysis-content">{{resultData.analysis.age_specific}}</view>
      </view>
      
      <!-- æµå¹´è¿åŠ¿ -->
      <view class="analysis-section" wx:if="{{resultData.analysis.yearly_fortune}}">
        <view class="analysis-title">æµå¹´è¿åŠ¿</view>
        <view class="analysis-content">{{resultData.analysis.yearly_fortune}}</view>
      </view>
      
      <!-- ä»Šæ—¥è¿åŠ¿ -->
      <view class="analysis-section">
        <view class="analysis-title">ä»Šæ—¥è¿åŠ¿</view>
        <view class="analysis-content">
          <view class="fortune-score">è¿åŠ¿è¯„åˆ†ï¼š{{resultData.today_fortune.score || 8}}/10</view>
          <view class="fortune-desc">{{resultData.today_fortune.description || 'ä»Šæ—¥è¿åŠ¿ä¸é”™...'}}</view>
        </view>
      </view>

      <!-- ä¹¦ç±æ¨èåŒºåŸŸ -->
      <view class="book-recommendation-section" wx:if="{{bookRecommendationContext}}">
        <book-recommendation 
          context="{{bookRecommendationContext}}"
          count="{{3}}"
          layout="list"
          title="ç›¸å…³ä¹¦ç±æ¨è"
          show-title="{{true}}"
          bind:bookclick="onBookClick"
          bind:bookcollect="onBookCollect"
          bind:bookshare="onBookShare">
        </book-recommendation>
      </view>
    </scroll-view>
    
    <view class="modal-footer">
      <button class="btn-save" bindtap="saveToHistory">ä¿å­˜åˆ°å†å²</button>
    </view>
  </view>
</view>
