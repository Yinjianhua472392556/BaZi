# 八字运势小程序 - 完整发布操作指南

> 从域名配置到成功上线的完整步骤说明

## 📋 发布前准备检查

### ✅ 必备条件确认
- [x] API服务器已部署完成（https://api.bazi365.top）
- [x] 所有API接口测试通过
- [x] 小程序代码中API地址已更新
- [ ] 微信小程序账号管理员权限
- [ ] 微信开发者工具已安装

---

## 🚀 第一阶段：域名配置（关键步骤）

### 步骤1：登录微信公众平台
1. **访问地址**：https://mp.weixin.qq.com
2. **登录方式**：
   - 使用小程序管理员微信扫码登录
   - 或使用账号密码登录
3. **确认权限**：确保有小程序管理权限

### 步骤2：配置服务器域名白名单 ⭐
1. **导航路径**：
   ```
   左侧菜单：开发 → 开发管理 → 开发设置
   ```

2. **找到"服务器域名"配置区域**

3. **配置request合法域名**：
   - 点击"request合法域名"右侧的"修改"按钮
   - 在输入框中添加：`https://api.bazi365.top`
   - 点击"保存并提交"

4. **重要提醒**：
   - 每月只能修改5次，请谨慎操作
   - 配置后需要等待几分钟生效
   - 必须是HTTPS协议

### 步骤3：验证域名配置
```bash
# 测试域名是否可访问
curl https://api.bazi365.top/health

# 预期返回包含 "healthy" 的JSON响应
```

---

## 🔧 第二阶段：开发环境测试

### 步骤4：微信开发者工具配置
1. **打开项目**：
   - 启动微信开发者工具
   - 选择并打开小程序项目目录：`bazi-miniprogram/miniprogram`

2. **开发调试设置**：
   - 点击右上角"详情"按钮
   - 勾选"不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书"
   - 这样可以在开发中跳过域名检查

### 步骤5：功能完整性测试
1. **八字测算功能**：
   - 输入生辰信息
   - 确认能正常获取八字结果
   - 检查数据显示正确

2. **起名功能**：
   - 输入姓氏和生辰信息
   - 确认能生成名字建议
   - 检查起名结果合理

3. **生肖配对功能**：
   - 选择两个生肖
   - 确认配对分析正常显示

4. **节日查询功能**：
   - 确认节日信息正常加载

5. **历史记录功能**：
   - 测试记录保存和查看

### 步骤6：真机预览测试
1. **生成预览码**：
   - 在开发者工具中点击"预览"
   - 生成二维码

2. **手机测试**：
   - 用手机微信扫码
   - 测试所有核心功能
   - 检查界面显示效果

3. **网络请求验证**：
   - 在开发者工具控制台查看网络请求
   - 确认API调用成功，无域名错误

---

## 📦 第三阶段：代码上传

### 步骤7：代码最终检查
1. **API地址确认**：
   ```javascript
   // 检查 miniprogram/app.js 中的配置
   globalData: {
     apiBaseUrl: 'https://api.bazi365.top',  // 确认是生产域名
   }
   ```

2. **清理调试代码**：
   - 移除 console.log 调试信息
   - 清理测试数据
   - 确认没有开发环境的临时代码

3. **功能最终验证**：
   - 所有页面能正常访问
   - 所有API调用正常
   - 界面显示正常

### 步骤8：上传到微信平台
1. **点击上传**：
   - 在微信开发者工具右上角点击"上传"

2. **填写版本信息**：
   ```
   版本号：v1.0.0
   项目备注：八字运势小程序首次发布版本，包含八字测算、起名、生肖配对等核心功能
   ```

3. **等待上传完成**：
   - 显示上传进度条
   - 上传完成后会显示"上传成功"

---

## 🧪 第四阶段：版本管理

### 步骤9：设置体验版本
1. **返回微信公众平台**：https://mp.weixin.qq.com

2. **进入版本管理**：
   ```
   左侧菜单：管理 → 版本管理
   ```

3. **找到开发版本**：
   - 在"开发版本"区域找到刚上传的版本
   - 版本号：v1.0.0

4. **设为体验版**：
   - 点击"选为体验版"
   - 确认设置

### 步骤10：添加体验者
1. **点击"体验者管理"**

2. **添加体验者微信号**：
   - 输入测试人员的微信号
   - 可以添加多个体验者

3. **发送体验版二维码**：
   - 生成体验版二维码
   - 发送给测试人员

### 步骤11：内部体验测试
1. **功能全面测试**：
   - 八字测算的准确性
   - 起名功能的实用性
   - 生肖配对的完整性
   - 界面交互的流畅性

2. **用户体验测试**：
   - 操作流程是否直观
   - 页面加载速度
   - 错误处理是否友好

3. **问题收集和修复**：
   - 记录发现的问题
   - 及时修复并重新上传

---

## 📝 第五阶段：提交审核

### 步骤12：准备审核材料
1. **功能说明**：
   ```
   八字运势小程序主要功能：
   
   1. 八字测算：根据用户输入的生辰八字（年、月、日、时），运用传统命理学算法，
      提供八字排盘、五行分析、性格特点、运势趋势等信息，仅供娱乐参考。
   
   2. 起名建议：结合用户的八字五行信息和姓氏，生成符合五行平衡的名字建议，
      包含字义解释和寓意说明，帮助用户了解姓名文化。
   
   3. 生肖配对：基于十二生肖的传统配对理论，分析两个生肖之间的相配程度，
      提供配对指数和建议，适用于娱乐和文化了解。
   
   4. 传统节日：展示中华传统节日信息，包括节日日期、由来、习俗等文化知识，
      弘扬传统文化。
   
   5. 历史记录：保存用户的测算记录，方便用户查看历史结果。
   
   注：本小程序提供的所有内容仅供娱乐和文化了解，不构成任何形式的建议或预测。
   ```

2. **使用场景说明**：
   ```
   适用场景：
   - 对传统文化感兴趣的用户
   - 寻求起名参考的用户
   - 希望了解生肖配对文化的用户
   - 学习传统节日知识的用户
   
   目标用户：
   - 对中华传统文化有兴趣的用户
   - 需要起名参考的家长
   - 喜欢传统命理文化的成年用户
   ```

### 步骤13：提交审核
1. **在体验版页面点击"提交审核"**

2. **选择功能页面**：
   - 逐一选择小程序的功能页面
   - 为每个页面选择对应的服务类目

3. **填写详细信息**：
   - 功能介绍：详细描述每个功能的作用
   - 使用方式：说明用户如何使用
   - 服务类目：选择"工具 → 其他"或相关类目

4. **上传补充材料**（如需要）：
   - 功能截图
   - 使用说明

5. **确认提交**：
   - 检查所有信息无误
   - 点击"提交审核"

---

## ⏳ 第六阶段：审核等待

### 步骤14：审核进度跟踪
1. **审核时间**：通常1-7个工作日

2. **查看审核状态**：
   - 在版本管理页面查看审核进度
   - 关注微信公众号通知

3. **可能的审核结果**：
   - ✅ **审核通过**：可以发布上线
   - ❌ **审核驳回**：需要根据反馈修改

### 步骤15：处理审核反馈（如需要）
1. **仔细阅读驳回原因**

2. **常见问题及解决方案**：
   ```
   问题：功能描述不清晰
   解决：补充详细的功能说明和使用场景
   
   问题：缺少必要的用户协议
   解决：添加用户协议和隐私政策页面
   
   问题：内容涉及敏感信息
   解决：调整内容表述，强调娱乐性质
   
   问题：缺少客服联系方式
   解决：在个人中心添加客服信息
   ```

3. **修改后重新提交**

---

## 🎉 第七阶段：正式发布

### 步骤16：发布上线
1. **收到审核通过通知**

2. **点击发布**：
   - 在版本管理页面找到审核通过的版本
   - 点击"发布"按钮
   - 确认发布操作

3. **发布成功确认**：
   - 看到"发布成功"提示
   - 小程序正式上线

### 步骤17：发布后验证
1. **搜索验证**：
   ```
   在微信中搜索小程序名称：八字运势
   确认能找到并正常使用
   ```

2. **功能测试**：
   - 测试所有核心功能
   - 确认线上版本与测试版本一致

3. **用户体验监控**：
   - 关注用户反馈
   - 监控使用数据
   - 及时解决问题

---

## 📊 发布后运营

### 数据监控
1. **访问数据**：
   - 日活跃用户数
   - 页面访问量
   - 功能使用率

2. **用户反馈**：
   - 用户评价和建议
   - 问题反馈处理

3. **性能监控**：
   - API响应时间
   - 错误率统计

### 版本迭代
1. **功能优化**：
   - 根据用户反馈优化功能
   - 修复发现的问题

2. **新功能开发**：
   - 规划新功能
   - 持续迭代更新

---

## ⚠️ 重要注意事项

### 关键配置
- ✅ **域名配置必须正确**：`https://api.bazi365.top`
- ✅ **必须使用HTTPS协议**
- ✅ **API服务必须稳定运行**

### 内容合规
- 强调娱乐性质，避免迷信色彩
- 不提供具体的人生建议
- 明确标注"仅供娱乐参考"

### 技术要求
- 小程序包大小不超过2MB
- 页面加载时间控制在3秒内
- 兼容不同尺寸的手机屏幕

---

## 🆘 常见问题解决

### 域名配置问题
```
问题：request:fail url not in domain list
解决：检查域名是否正确添加到白名单，注意HTTPS协议
```

### 审核不通过
```
问题：功能涉及算命占卜
解决：调整文案，强调文化娱乐属性，避免算命字眼
```

### 上传失败
```
问题：代码包过大
解决：优化图片资源，清理无用文件
```

### 真机测试异常
```
问题：真机上功能异常
解决：检查网络请求，确认API服务状态
```

---

## 📞 技术支持

如遇到技术问题，可以：
1. 查看微信小程序官方文档
2. 检查API服务运行状态
3. 查看开发者工具控制台错误信息

---

**发布指南版本**：v1.0.0  
**最后更新**：2025-10-10  
**适用小程序**：八字运势小程序

🎯 **目标**：确保小程序
